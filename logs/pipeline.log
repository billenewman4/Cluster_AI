2025-06-06 19:04:25,634 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 19:04:25,635 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 19:04:25,635 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 19:04:25,635 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 19:04:25,635 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 19:04:25,635 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 19:04:25,636 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 19:04:25,636 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 19:04:25,636 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 19:04:25,910 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 19:04:25,911 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 19:04:25,911 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 19:04:25,911 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 19:04:25,918 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 19:04:25,918 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 19:04:25,921 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 19:04:25,921 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 19:04:25,921 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 19:04:25,921 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 19:04:25,922 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 19:04:25,923 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 19:04:25,932 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 19:04:25,932 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 19:04:25,938 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 19:04:25,943 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 19:04:25,948 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 19:04:25,949 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 19:04:25,960 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 19:04:25,963 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 19:04:25,967 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 19:04:26,010 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 19:04:26,010 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 19:04:26,010 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 19:04:26,178 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 19:04:26,179 - __main__ - INFO - Available categories in data: ['Uncategorized']
2025-06-06 19:04:26,180 - __main__ - INFO - Category counts: {'Uncategorized': 1049}
2025-06-06 19:04:26,180 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 19:04:26,180 - __main__ - INFO - Found 0 records for Beef Chuck
2025-06-06 19:04:26,180 - __main__ - WARNING - No records found for exact 'Beef Chuck' match, trying word boundaries
2025-06-06 19:04:26,181 - __main__ - INFO - Found 0 records with word boundary matching
2025-06-06 19:04:26,181 - __main__ - WARNING - Still no records found for Beef Chuck
2025-06-06 19:04:26,181 - __main__ - INFO - Sample categories:
['Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized']
2025-06-06 19:04:26,181 - __main__ - ERROR - No results to process. Exiting.
2025-06-06 19:07:04,527 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 19:07:04,527 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 19:07:04,527 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 19:07:04,527 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 19:07:04,528 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 19:07:04,528 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 19:07:04,528 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 19:07:04,528 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 19:07:04,528 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 19:07:04,691 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 19:07:04,692 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 19:07:04,692 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 19:07:04,694 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 19:07:04,697 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 19:07:04,697 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 19:07:04,705 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 19:07:04,705 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 19:07:04,706 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 19:07:04,708 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 19:07:04,709 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 19:07:04,710 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 19:07:04,711 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 19:07:04,711 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 19:07:04,731 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 19:07:04,735 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 19:07:04,743 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 19:07:04,744 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 19:07:04,754 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 19:07:04,757 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 19:07:04,761 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 19:07:04,812 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 19:07:04,812 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 19:07:04,812 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 19:07:05,060 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 19:07:05,061 - __main__ - INFO - Available categories in data: ['Uncategorized']
2025-06-06 19:07:05,063 - __main__ - INFO - Category counts: {'Uncategorized': 1049}
2025-06-06 19:07:05,063 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 19:07:05,064 - __main__ - INFO - Found 0 records for Beef Chuck
2025-06-06 19:07:05,064 - __main__ - WARNING - No records found for exact 'Beef Chuck' match, trying word boundaries
2025-06-06 19:07:05,065 - __main__ - INFO - Found 0 records with word boundary matching
2025-06-06 19:07:05,065 - __main__ - WARNING - Still no records found for Beef Chuck
2025-06-06 19:07:05,065 - __main__ - INFO - Sample categories:
['Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized']
2025-06-06 19:07:05,065 - __main__ - ERROR - No results to process. Exiting.
2025-06-06 19:08:34,162 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 19:08:34,162 - __main__ - INFO - Categories to process: ['Pork Hams']
2025-06-06 19:08:34,162 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 19:08:34,162 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 19:08:34,162 - __main__ - ERROR - Error processing product query file: name 'pd' is not defined
2025-06-06 19:08:34,162 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 19:08:34,163 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 19:08:34,163 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 19:08:34,163 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 19:08:34,163 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 19:08:34,164 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 19:08:34,435 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 19:08:34,435 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 19:08:34,435 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 19:08:34,435 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 19:08:34,438 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 19:08:34,438 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 19:08:34,444 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 19:08:34,444 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 19:08:34,444 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 19:08:34,445 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 19:08:34,445 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 19:08:34,446 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 19:08:34,446 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 19:08:34,447 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 19:08:34,462 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 19:08:34,468 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 19:08:34,471 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 19:08:34,475 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 19:08:34,484 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 19:08:34,487 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 19:08:34,491 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 19:08:34,538 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 19:08:34,538 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 19:08:34,538 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 19:08:34,539 - __main__ - WARNING - No extractor available for category: Pork Hams
2025-06-06 19:08:34,539 - __main__ - ERROR - No extractors configured. Exiting.
2025-06-06 19:33:31,890 - __main__ - ERROR - Cannot run full pipeline: Required processing modules missing
2025-06-06 19:34:29,885 - __main__ - ERROR - Cannot run full pipeline: Required processing modules missing
2025-06-06 19:34:57,312 - __main__ - ERROR - Cannot run full pipeline: Required processing modules missing
2025-06-06 19:35:30,589 - __main__ - ERROR - Cannot run full pipeline: Required processing modules missing
2025-06-06 19:39:23,474 - __main__ - ERROR - Cannot run full pipeline: Required processing modules missing
2025-06-06 19:39:38,292 - __main__ - ERROR - Cannot run full pipeline: Required processing modules missing
2025-06-06 19:40:48,427 - __main__ - ERROR - Cannot run full pipeline: Required processing modules missing
2025-06-06 19:43:49,294 - __main__ - ERROR - Cannot run full pipeline: Required processing modules missing
2025-06-06 19:44:58,780 - __main__ - ERROR - Cannot run full pipeline: Required processing modules missing
2025-06-06 19:45:04,301 - __main__ - ERROR - Cannot run full pipeline: Required processing modules missing
2025-06-06 19:46:52,076 - __main__ - ERROR - Cannot run full pipeline: Required processing modules missing
2025-06-06 19:48:16,168 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 19:48:16,169 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 19:48:16,169 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 19:48:16,169 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 19:48:16,169 - __main__ - ERROR - Error processing product query file: name 'pd' is not defined
2025-06-06 19:48:16,169 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 19:48:16,170 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 19:48:16,170 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 19:48:16,170 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 19:48:16,170 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 19:48:16,170 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 19:48:16,345 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 19:48:16,346 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 19:48:16,346 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 19:48:16,346 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 19:48:16,354 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 19:48:16,354 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 19:48:16,357 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 19:48:16,357 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 19:48:16,358 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 19:48:16,358 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 19:48:16,358 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 19:48:16,360 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 19:48:16,375 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 19:48:16,379 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 19:48:16,384 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 19:48:16,384 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 19:48:16,393 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 19:48:16,394 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 19:48:16,405 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 19:48:16,408 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 19:48:16,412 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 19:48:16,465 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 19:48:16,465 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 19:48:16,465 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 19:48:16,604 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 19:48:16,605 - src.LLM.extractors.dynamic_beef_extractor - INFO - Initialized dynamic beef extractor with 11 primal cuts
2025-06-06 19:48:16,605 - __main__ - INFO - Loaded dynamic beef extractor with 11 supported primal cuts
2025-06-06 19:48:16,605 - __main__ - INFO - Using dynamic beef extractor for category: Beef Chuck
2025-06-06 19:48:16,845 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 19:48:16,846 - __main__ - INFO - Available categories in data: ['Uncategorized']
2025-06-06 19:48:16,849 - __main__ - INFO - Category counts: {'Uncategorized': 1049}
2025-06-06 19:48:16,849 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 19:48:16,849 - __main__ - INFO - Found 0 records for Beef Chuck
2025-06-06 19:48:16,849 - __main__ - WARNING - No records found for exact 'Beef Chuck' match, trying word boundaries
2025-06-06 19:48:16,850 - __main__ - INFO - Found 0 records with word boundary matching
2025-06-06 19:48:16,850 - __main__ - WARNING - Still no records found for Beef Chuck
2025-06-06 19:48:16,850 - __main__ - INFO - Sample categories:
['Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized']
2025-06-06 19:48:16,850 - __main__ - ERROR - No results to process. Exiting.
2025-06-06 19:49:41,489 - __main__ - ERROR - Cannot run full pipeline: Required processing modules missing
2025-06-06 19:59:05,749 - __main__ - ERROR - Cannot run full pipeline: Required processing modules missing
2025-06-06 20:00:33,801 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 20:00:33,801 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 20:00:33,801 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 20:00:33,801 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 20:00:33,801 - __main__ - ERROR - Error processing product query file: name 'pd' is not defined
2025-06-06 20:00:33,801 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 20:00:33,802 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 20:00:33,802 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 20:00:33,802 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 20:00:33,802 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 20:00:33,803 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 20:00:33,964 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:00:33,964 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:00:33,965 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:00:33,965 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:00:33,972 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 20:00:33,972 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 20:00:33,974 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:00:33,974 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:00:33,975 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 20:00:33,975 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:00:33,975 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:00:33,976 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 20:00:33,978 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:00:33,979 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:00:33,995 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:00:33,999 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:00:34,006 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 20:00:34,008 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 20:00:34,015 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:00:34,019 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 20:00:34,022 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 20:00:34,070 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 20:00:34,070 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 20:00:34,070 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 20:00:34,200 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:00:34,200 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:00:34,200 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 20:00:34,200 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 20:00:34,384 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 20:00:34,385 - __main__ - INFO - Available categories in data: ['Uncategorized']
2025-06-06 20:00:34,387 - __main__ - INFO - Category counts: {'Uncategorized': 1049}
2025-06-06 20:00:34,387 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 20:00:34,387 - __main__ - INFO - Found 0 records for Beef Chuck
2025-06-06 20:00:34,388 - __main__ - WARNING - No records found for exact 'Beef Chuck' match, trying word boundaries
2025-06-06 20:00:34,388 - __main__ - INFO - Found 0 records with word boundary matching
2025-06-06 20:00:34,388 - __main__ - WARNING - Still no records found for Beef Chuck
2025-06-06 20:00:34,388 - __main__ - INFO - Sample categories:
['Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized']
2025-06-06 20:00:34,388 - __main__ - ERROR - No results to process. Exiting.
2025-06-06 20:37:20,758 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 20:37:20,758 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 20:37:20,758 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 20:37:20,758 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 20:37:20,758 - __main__ - ERROR - Error processing product query file: name 'pd' is not defined
2025-06-06 20:37:20,758 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 20:37:20,759 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 20:37:20,759 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 20:37:20,759 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 20:37:20,759 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 20:37:20,759 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 20:37:21,115 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:37:21,116 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:37:21,116 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:37:21,116 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:37:21,122 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 20:37:21,123 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 20:37:21,127 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:37:21,127 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:37:21,127 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 20:37:21,127 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:37:21,128 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:37:21,129 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 20:37:21,129 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:37:21,133 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:37:21,145 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:37:21,154 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:37:21,161 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 20:37:21,162 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 20:37:21,172 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:37:21,176 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 20:37:21,179 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 20:37:21,277 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 20:37:21,277 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 20:37:21,278 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 20:37:21,403 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:37:21,403 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:37:21,403 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 20:37:21,403 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 20:37:21,555 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 20:37:21,556 - __main__ - INFO - Available categories in data: ['Uncategorized']
2025-06-06 20:37:21,557 - __main__ - INFO - Category counts: {'Uncategorized': 1049}
2025-06-06 20:37:21,557 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 20:37:21,558 - __main__ - INFO - Found 0 records for Beef Chuck
2025-06-06 20:37:21,558 - __main__ - WARNING - No records found for exact 'Beef Chuck' match, trying word boundaries
2025-06-06 20:37:21,559 - __main__ - INFO - Found 0 records with word boundary matching
2025-06-06 20:37:21,559 - __main__ - WARNING - Still no records found for Beef Chuck
2025-06-06 20:37:21,559 - __main__ - INFO - Sample categories:
['Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized', 'Uncategorized']
2025-06-06 20:37:21,559 - __main__ - ERROR - No results to process. Exiting.
2025-06-06 20:41:35,781 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 20:41:35,781 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 20:41:35,781 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 20:41:35,781 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 20:41:35,781 - __main__ - ERROR - Error processing product query file: name 'pd' is not defined
2025-06-06 20:41:35,781 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 20:41:35,782 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 20:41:35,782 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 20:41:35,782 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 20:41:35,782 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 20:41:35,783 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 20:41:35,951 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:41:35,951 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:41:35,951 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:41:35,951 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:41:35,958 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 20:41:35,960 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 20:41:35,962 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:41:35,963 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:41:35,963 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 20:41:35,964 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:41:35,965 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:41:35,965 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 20:41:35,965 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:41:35,967 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:41:35,994 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:41:36,002 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 20:41:36,005 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:41:36,011 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 20:41:36,027 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description']
2025-06-06 20:41:36,027 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 20:41:36,031 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 20:41:36,082 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 20:41:36,082 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 20:41:36,083 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 20:41:36,233 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:41:36,233 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:41:36,233 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 20:41:36,233 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 20:41:36,291 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 20:41:36,292 - __main__ - INFO - Available categories in data: ['Uncategorized' 'Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground'
 'Miscellaneous Beef' 'Pork Rib' 'Pork Other' 'Rib' 'Beef Flank'
 'Pork Loin' 'Misc. Items' 'Beef Chuck' 'Chicken Misc.'
 'Chicken Airline Breast' 'Ground Beef Anmar Production'
 'Beef Variety & Misc' 'Beef Other' 'Delete Items' 'Beef Rib'
 'Beef Ground' 'Lamb' 'Hot Dogs' 'Beef Round' 'Pork Sausage' 'Beef Loin'
 'Goat' 'Wild Game' 'Veal' 'Halal' 'Supplies' 'Pot Sticker' 'Dim Sum'
 'Beef,Pork-Sausage,Smok' 'Pork Ham/Leg' 'Rabbit' 'DISCONTINUED ITEMS'
 'Pork Butt' 'Chicken Main' 'Pork Variety' 'Ground Beef' 'Poultry Leg'
 'Pork Shoulder' 'Pork Belly' 'Veal Strauss' 'Brisket' 'Chicken Variety'
 'Plate' 'Game Meat' 'Duck' 'Poultry Breast' 'Poultry Whole' 'Turkey'
 'Poultry Drumstick' 'Poultry Thigh' 'Poultry Tender' 'Poultry Wing'
 'Poultry Other' 'Misc' 'Chicken Wings' 'Chicken Leg Meat']
2025-06-06 20:41:36,294 - __main__ - INFO - Category counts: {'Beef Rib': 87, 'Pork Loin': 85, 'Pork Other': 81, 'Beef Flank': 80, 'Beef Chuck': 68, 'Chicken Main': 68, 'Uncategorized': 49, 'Delete Items': 48, 'Pork Rib': 48, 'Poultry Breast': 46, 'Misc': 28, 'Duck': 24, 'Pork Ham/Leg': 23, 'Misc. Items': 18, 'Dim Sum': 18, 'Miscellaneous Beef': 15, 'Goat': 15, 'Ground Beef Anmar Production': 12, 'Pork Shoulder': 12, 'Poultry Ground': 12, 'DISCONTINUED ITEMS': 12, 'Beef,Pork-Sausage,Smok': 12, 'Pork Variety': 11, 'Beef Variety & Misc': 10, 'Beef Ground': 10, 'Plate': 9, 'Poultry Thigh': 9, 'Chicken Leg Meat': 9, 'Beef Loin': 8, 'Lamb': 7, 'Ground Beef': 7, 'Turkey': 6, 'Chicken Variety': 6, 'Wild Game': 6, 'Beef Round': 6, 'Brisket': 6, 'Poultry Whole': 5, 'Poultry Tender': 4, 'Poultry Other': 4, 'Poultry Wing': 4, 'Pork Butt': 4, 'Poultry Leg': 4, 'Poultry Drumstick': 4, 'Pork Belly': 4, 'Veal': 3, 'Chicken Misc.': 3, 'Pork Hams': 3, 'Chicken Wings': 3, 'Rib': 3, 'Veal Strauss': 3, 'Game Meat': 3, 'Chicken Airline Breast': 3, 'Halal': 3, 'Rabbit': 3, 'Pork Sausage': 3, 'Pot Sticker': 3, 'Non Product': 3, 'Supplies': 3, 'Beef Other': 1, 'Sausage': 1, 'Hot Dogs': 1}
2025-06-06 20:41:36,294 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 20:41:36,294 - __main__ - INFO - Found 68 records for Beef Chuck
2025-06-06 20:41:36,295 - __main__ - INFO - Test run: Processing only 10 records
2025-06-06 20:41:36,295 - llm_extraction.batch_processor - INFO - Processing 10 records for Beef Chuck
2025-06-06 20:41:36,296 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:36,802 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:36,896 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:36,897 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:36,897 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:36,897 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:37,398 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:37,399 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:37,399 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:37,399 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:37,803 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:37,803 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:41:38,306 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:38,399 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:41:38,399 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:41:38,403 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:38,403 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:38,404 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:41:38,404 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:41:38,906 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:38,906 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:39,006 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:39,006 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:39,306 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:41:39,507 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:39,509 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:41:39,907 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:41:39,907 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:41:40,508 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:41:40,513 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:41:40,518 - llm_extraction.batch_processor - INFO - Batch processing complete. 10 records processed.
2025-06-06 20:41:40,518 - __main__ - INFO - Successfully processed 10 records for Beef Chuck
2025-06-06 20:41:40,518 - __main__ - INFO - 📤 Stage 3: Output Generation
2025-06-06 20:41:40,520 - output_generation.file_writer - INFO - Separated data: 0 clean records, 10 flagged records
2025-06-06 20:41:40,522 - output_generation.file_writer - INFO - Written 10 flagged records to outputs/beef_chuck_extracted_flagged.csv
2025-06-06 20:41:40,522 - __main__ - INFO - Output files created: ['Beef Chuck']
2025-06-06 20:41:40,522 - __main__ - INFO - ⏭️ Stage 4: Database Upload (Skipped - use --upload-to-firebase to enable)
2025-06-06 20:41:40,522 - __main__ - INFO - ✅ Pipeline Complete!
2025-06-06 20:41:40,522 - __main__ - INFO - 📊 Summary:
2025-06-06 20:41:40,522 - __main__ - INFO -    Total records processed: 10
2025-06-06 20:41:40,522 - __main__ - INFO -    Records needing review: 10 (100.0%)
2025-06-06 20:41:40,522 - __main__ - INFO -    Average confidence: 0.00
2025-06-06 20:41:40,522 - __main__ - WARNING - Some records need review - check flagged output files
2025-06-06 20:42:06,309 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 20:42:06,309 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 20:42:06,309 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 20:42:06,309 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 20:42:06,309 - __main__ - ERROR - Error processing product query file: name 'pd' is not defined
2025-06-06 20:42:06,309 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 20:42:06,309 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 20:42:06,310 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 20:42:06,310 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 20:42:06,310 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 20:42:06,310 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 20:42:06,477 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:42:06,478 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:42:06,478 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:42:06,479 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:42:06,487 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 20:42:06,487 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 20:42:06,489 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:42:06,490 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:42:06,490 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:42:06,490 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 20:42:06,490 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:42:06,492 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 20:42:06,496 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:42:06,501 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:42:06,511 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:42:06,518 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:42:06,522 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 20:42:06,524 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 20:42:06,535 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description']
2025-06-06 20:42:06,536 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 20:42:06,540 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 20:42:06,591 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 20:42:06,591 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 20:42:06,591 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 20:42:06,733 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:42:06,733 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:42:06,733 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 20:42:06,734 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 20:42:06,808 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 20:42:06,810 - __main__ - INFO - Available categories in data: ['Uncategorized' 'Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground'
 'Miscellaneous Beef' 'Pork Rib' 'Pork Other' 'Rib' 'Beef Flank'
 'Pork Loin' 'Misc. Items' 'Beef Chuck' 'Chicken Misc.'
 'Chicken Airline Breast' 'Ground Beef Anmar Production'
 'Beef Variety & Misc' 'Beef Other' 'Delete Items' 'Beef Rib'
 'Beef Ground' 'Lamb' 'Hot Dogs' 'Beef Round' 'Pork Sausage' 'Beef Loin'
 'Goat' 'Wild Game' 'Veal' 'Halal' 'Supplies' 'Pot Sticker' 'Dim Sum'
 'Beef,Pork-Sausage,Smok' 'Pork Ham/Leg' 'Rabbit' 'DISCONTINUED ITEMS'
 'Pork Butt' 'Chicken Main' 'Pork Variety' 'Ground Beef' 'Poultry Leg'
 'Pork Shoulder' 'Pork Belly' 'Veal Strauss' 'Brisket' 'Chicken Variety'
 'Plate' 'Game Meat' 'Duck' 'Poultry Breast' 'Poultry Whole' 'Turkey'
 'Poultry Drumstick' 'Poultry Thigh' 'Poultry Tender' 'Poultry Wing'
 'Poultry Other' 'Misc' 'Chicken Wings' 'Chicken Leg Meat']
2025-06-06 20:42:06,811 - __main__ - INFO - Category counts: {'Beef Rib': 87, 'Pork Loin': 85, 'Pork Other': 81, 'Beef Flank': 80, 'Beef Chuck': 68, 'Chicken Main': 68, 'Uncategorized': 49, 'Delete Items': 48, 'Pork Rib': 48, 'Poultry Breast': 46, 'Misc': 28, 'Duck': 24, 'Pork Ham/Leg': 23, 'Misc. Items': 18, 'Dim Sum': 18, 'Miscellaneous Beef': 15, 'Goat': 15, 'Ground Beef Anmar Production': 12, 'Pork Shoulder': 12, 'Poultry Ground': 12, 'DISCONTINUED ITEMS': 12, 'Beef,Pork-Sausage,Smok': 12, 'Pork Variety': 11, 'Beef Variety & Misc': 10, 'Beef Ground': 10, 'Plate': 9, 'Poultry Thigh': 9, 'Chicken Leg Meat': 9, 'Beef Loin': 8, 'Lamb': 7, 'Ground Beef': 7, 'Turkey': 6, 'Chicken Variety': 6, 'Wild Game': 6, 'Beef Round': 6, 'Brisket': 6, 'Poultry Whole': 5, 'Poultry Tender': 4, 'Poultry Other': 4, 'Poultry Wing': 4, 'Pork Butt': 4, 'Poultry Leg': 4, 'Poultry Drumstick': 4, 'Pork Belly': 4, 'Veal': 3, 'Chicken Misc.': 3, 'Pork Hams': 3, 'Chicken Wings': 3, 'Rib': 3, 'Veal Strauss': 3, 'Game Meat': 3, 'Chicken Airline Breast': 3, 'Halal': 3, 'Rabbit': 3, 'Pork Sausage': 3, 'Pot Sticker': 3, 'Non Product': 3, 'Supplies': 3, 'Beef Other': 1, 'Sausage': 1, 'Hot Dogs': 1}
2025-06-06 20:42:06,811 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 20:42:06,812 - __main__ - INFO - Found 68 records for Beef Chuck
2025-06-06 20:42:06,812 - __main__ - INFO - Test run: Processing only 10 records
2025-06-06 20:42:06,812 - llm_extraction.batch_processor - INFO - Processing 10 records for Beef Chuck
2025-06-06 20:42:06,814 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:07,314 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:07,415 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:07,415 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:07,415 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:07,419 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:07,916 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:07,916 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:07,916 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:07,924 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:08,316 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:08,316 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:42:08,830 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:08,921 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:08,925 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:42:08,926 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:42:08,926 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:42:08,927 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:42:09,426 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:09,522 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:09,525 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:09,525 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:09,831 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:42:10,025 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:10,026 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:10,026 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: 'ReferenceDataLoader' object has no attribute 'get_subprimals_for_primal'
2025-06-06 20:42:10,439 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:42:11,047 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:42:11,047 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:42:11,047 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:42:11,079 - llm_extraction.batch_processor - INFO - Batch processing complete. 10 records processed.
2025-06-06 20:42:11,080 - __main__ - INFO - Successfully processed 10 records for Beef Chuck
2025-06-06 20:42:11,080 - __main__ - INFO - 📤 Stage 3: Output Generation
2025-06-06 20:42:11,112 - output_generation.file_writer - INFO - Separated data: 0 clean records, 10 flagged records
2025-06-06 20:42:11,126 - output_generation.file_writer - INFO - Written 10 flagged records to outputs/beef_chuck_extracted_flagged.csv
2025-06-06 20:42:11,127 - __main__ - INFO - Output files created: ['Beef Chuck']
2025-06-06 20:42:11,127 - __main__ - INFO - ⏭️ Stage 4: Database Upload (Skipped - use --upload-to-firebase to enable)
2025-06-06 20:42:11,127 - __main__ - INFO - ✅ Pipeline Complete!
2025-06-06 20:42:11,127 - __main__ - INFO - 📊 Summary:
2025-06-06 20:42:11,127 - __main__ - INFO -    Total records processed: 10
2025-06-06 20:42:11,127 - __main__ - INFO -    Records needing review: 10 (100.0%)
2025-06-06 20:42:11,127 - __main__ - INFO -    Average confidence: 0.00
2025-06-06 20:42:11,127 - __main__ - WARNING - Some records need review - check flagged output files
2025-06-06 20:44:32,872 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 20:44:32,873 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 20:44:32,873 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 20:44:32,873 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 20:44:32,873 - __main__ - ERROR - Error processing product query file: name 'pd' is not defined
2025-06-06 20:44:32,874 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 20:44:32,874 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 20:44:32,875 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 20:44:32,875 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 20:44:32,876 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 20:44:32,877 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 20:44:33,404 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:44:33,405 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:44:33,405 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:44:33,405 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:44:33,418 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 20:44:33,418 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 20:44:33,423 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:44:33,424 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:44:33,424 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:44:33,424 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 20:44:33,425 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:44:33,432 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 20:44:33,435 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:44:33,436 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:44:33,462 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:44:33,477 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:44:33,490 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 20:44:33,493 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 20:44:33,511 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description']
2025-06-06 20:44:33,512 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 20:44:33,534 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 20:44:33,656 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 20:44:33,656 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 20:44:33,657 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 20:44:34,524 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:44:34,524 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:44:34,524 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 20:44:34,524 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 20:44:34,693 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 20:44:34,695 - __main__ - INFO - Available categories in data: ['Uncategorized' 'Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground'
 'Miscellaneous Beef' 'Pork Rib' 'Pork Other' 'Rib' 'Beef Flank'
 'Pork Loin' 'Misc. Items' 'Beef Chuck' 'Chicken Misc.'
 'Chicken Airline Breast' 'Ground Beef Anmar Production'
 'Beef Variety & Misc' 'Beef Other' 'Delete Items' 'Beef Rib'
 'Beef Ground' 'Lamb' 'Hot Dogs' 'Beef Round' 'Pork Sausage' 'Beef Loin'
 'Goat' 'Wild Game' 'Veal' 'Halal' 'Supplies' 'Pot Sticker' 'Dim Sum'
 'Beef,Pork-Sausage,Smok' 'Pork Ham/Leg' 'Rabbit' 'DISCONTINUED ITEMS'
 'Pork Butt' 'Chicken Main' 'Pork Variety' 'Ground Beef' 'Poultry Leg'
 'Pork Shoulder' 'Pork Belly' 'Veal Strauss' 'Brisket' 'Chicken Variety'
 'Plate' 'Game Meat' 'Duck' 'Poultry Breast' 'Poultry Whole' 'Turkey'
 'Poultry Drumstick' 'Poultry Thigh' 'Poultry Tender' 'Poultry Wing'
 'Poultry Other' 'Misc' 'Chicken Wings' 'Chicken Leg Meat']
2025-06-06 20:44:34,696 - __main__ - INFO - Category counts: {'Beef Rib': 87, 'Pork Loin': 85, 'Pork Other': 81, 'Beef Flank': 80, 'Beef Chuck': 68, 'Chicken Main': 68, 'Uncategorized': 49, 'Delete Items': 48, 'Pork Rib': 48, 'Poultry Breast': 46, 'Misc': 28, 'Duck': 24, 'Pork Ham/Leg': 23, 'Misc. Items': 18, 'Dim Sum': 18, 'Miscellaneous Beef': 15, 'Goat': 15, 'Ground Beef Anmar Production': 12, 'Pork Shoulder': 12, 'Poultry Ground': 12, 'DISCONTINUED ITEMS': 12, 'Beef,Pork-Sausage,Smok': 12, 'Pork Variety': 11, 'Beef Variety & Misc': 10, 'Beef Ground': 10, 'Plate': 9, 'Poultry Thigh': 9, 'Chicken Leg Meat': 9, 'Beef Loin': 8, 'Lamb': 7, 'Ground Beef': 7, 'Turkey': 6, 'Chicken Variety': 6, 'Wild Game': 6, 'Beef Round': 6, 'Brisket': 6, 'Poultry Whole': 5, 'Poultry Tender': 4, 'Poultry Other': 4, 'Poultry Wing': 4, 'Pork Butt': 4, 'Poultry Leg': 4, 'Poultry Drumstick': 4, 'Pork Belly': 4, 'Veal': 3, 'Chicken Misc.': 3, 'Pork Hams': 3, 'Chicken Wings': 3, 'Rib': 3, 'Veal Strauss': 3, 'Game Meat': 3, 'Chicken Airline Breast': 3, 'Halal': 3, 'Rabbit': 3, 'Pork Sausage': 3, 'Pot Sticker': 3, 'Non Product': 3, 'Supplies': 3, 'Beef Other': 1, 'Sausage': 1, 'Hot Dogs': 1}
2025-06-06 20:44:34,697 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 20:44:34,701 - __main__ - INFO - Found 68 records for Beef Chuck
2025-06-06 20:44:34,701 - __main__ - INFO - Test run: Processing only 10 records
2025-06-06 20:44:34,701 - llm_extraction.batch_processor - INFO - Processing 10 records for Beef Chuck
2025-06-06 20:44:35,278 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-986d3804-e665-41be-b0bd-6f2ae01ead7b', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:35,310 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-c2e49b67-43fe-4658-a5c1-ba636f835bfd', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:35,314 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-c89f3389-9e58-4691-b8e3-6ee6e2f011d2', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:35,320 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-81ed6823-1984-4929-96a6-0e8816ffeed9', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:35,322 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-2a839658-bd52-486f-8e24-d943fa951821', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:35,388 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:35,419 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:35,422 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:35,423 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:35,431 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:36,989 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:36,990 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:36,992 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:44:36 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '816'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '822'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_dd7c5a201684389167169d46893f6bad'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=IJlj5w6qfkxj92dl8S.Pvo7N4yOkGiLvbsC9QvI2X1U-1749257076-1.0.1.1-tQvyqqVQa.1MZQjYjqWScskkxxeDemqG601xtW5k6E3FiK8pWCFuMSTsQy4bsj.3k96ZrC9PQZPaKyNUMmw0tHfolwbo2J1ItVU8JPxMkKM; path=/; expires=Sat, 07-Jun-25 01:14:36 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=NI4e7g6_UDmO9XQCM6Qm8nkLvLtFX0EwbBYJkmtYu3o-1749257076967-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc1f327947304d-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:44:36,992 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:44:37 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '819'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '821'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_6c262bcb0d3cfe924f4b57982d23083e'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=WO2EMAfSvcHLoqowBcpor8axX8SElg4fwYqA05TKdrs-1749257077-1.0.1.1-BIKUpiDopUOqwSyFaJXhpPCpoai4AFgIE_rzdP2lPqnybj5zyUtQx7Vyx2V5I2TjeOl5paOtngXYVEurLMT0RQDRT_Je6OBcicrgusKQK4s; path=/; expires=Sat, 07-Jun-25 01:14:37 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=35cZH41wkYYeUlLwbwyjGTsAXuOwmHtk3Tueo3OUmlg-1749257077008-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc1f327a288fe7-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:44:36,992 - openai._base_client - DEBUG - request_id: req_dd7c5a201684389167169d46893f6bad
2025-06-06 20:44:36,992 - openai._base_client - DEBUG - request_id: req_6c262bcb0d3cfe924f4b57982d23083e
2025-06-06 20:44:37,004 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:44:37,004 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:44:37,506 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-e95e6578-97b5-4bf0-a41c-6b944bb50b4f', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:37,507 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:37,508 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-7daf49d1-8e29-49b6-9584-63257f88c7b9', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:37,510 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:37,615 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:37,616 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:44:37 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1483'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1491'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_f1ff97178e79fed9eb3d5f8e20fcaa60'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=aHAvdJ5FI0CzccBBM6YhecoZ3MiSG5THSP6iY3CDs0o-1749257077-1.0.1.1-puf8ziYsOqwHYnq.xAR0TlgfWOjn67QwPgmQuYwPCwSjrAI_49cpeJMP4L1ZnGAtZO4MfApK8jQxpmf92J0LuF0MJ.ns0a0Jy6gqr_PidOQ; path=/; expires=Sat, 07-Jun-25 01:14:37 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=i9l355OpSEHbibUkJ2X66DPyk.jfU3IQsDtX3h4teDQ-1749257077631-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc1f327b7c8fb7-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:44:37,616 - openai._base_client - DEBUG - request_id: req_f1ff97178e79fed9eb3d5f8e20fcaa60
2025-06-06 20:44:37,617 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:44:37,766 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:37,768 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:44:37 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1391'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1395'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_42d8bfe6aa7a2beedf1e25a01d3ffb42'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=WxnUgvdE40xhIF9BKUPD2lTkhGikfBjPm6KcAYsbQE0-1749257077-1.0.1.1-7k2goyd8EXrqbNhjOQ39WPX4_QyEVXGdmPthTJjfMr7vx4rzxFk_.cNIQNZeo6A22zeWF6s2TIlf8N1iQftrngV30HsF3QQD4rNcrZqCuMI; path=/; expires=Sat, 07-Jun-25 01:14:37 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=.NKLMsxFadywOrBvftLKEyenPOHnq6aYesdt7uChX84-1749257077782-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc1f327c018fd3-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:44:37,769 - openai._base_client - DEBUG - request_id: req_42d8bfe6aa7a2beedf1e25a01d3ffb42
2025-06-06 20:44:37,769 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:44:37,789 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:37,790 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:44:37 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1471'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1475'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_d0652ef7105d6360b81f702cab802ac9'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=yP.HVVtO1KiUEFYRdLCNHXvaEqoS5NKPojgS5faB50E-1749257077-1.0.1.1-XenFx8wO8RU2aHkgAx7Xy8xSiCX7SGYpNA2sVQ1dGveVTD0IUh16iceT9TcuOObcKP4XgVV7qYDxRZ21KoLcnRVoYU1_hHsItAa6b90DsOk; path=/; expires=Sat, 07-Jun-25 01:14:37 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=j6zTreu8VLRrGvLn_CnA0_jkDhZwR34Qr3Wai1WEmuc-1749257077805-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc1f328e684d13-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:44:37,790 - openai._base_client - DEBUG - request_id: req_d0652ef7105d6360b81f702cab802ac9
2025-06-06 20:44:37,791 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:44:38,127 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-bd24ccba-4126-4a98-be48-6f8f52653718', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:38,132 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:38,281 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-2fecec4c-91ee-4450-b437-932c6c03d000', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:38,288 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:38,297 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-78b009be-0292-4963-ad3d-6684fab18673', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:38,299 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:38,514 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:38,533 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:38 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '909', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '913', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_0b80eb1fa5b9717c75e201ef1a38d072', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f3ebcfa304d-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:38,538 - openai._base_client - DEBUG - request_id: req_0b80eb1fa5b9717c75e201ef1a38d072
2025-06-06 20:44:38,539 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:44:38,660 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:38,667 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:38 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1047', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1054', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_f93d349fca94c1151d535ffba3db7457', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f3eab478fe7-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:38,682 - openai._base_client - DEBUG - request_id: req_f93d349fca94c1151d535ffba3db7457
2025-06-06 20:44:38,683 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:44:39,114 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:39,118 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:39 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '890', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '895', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_de80fb8d56773fe3687deba7b72b963e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f429b948fb7-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:39,119 - openai._base_client - DEBUG - request_id: req_de80fb8d56773fe3687deba7b72b963e
2025-06-06 20:44:39,120 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:44:39,304 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:39,305 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:39 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '901', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '905', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_9ff682146ac09e6629f2afe9727f44f7', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f43bd088fd3-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:39,306 - openai._base_client - DEBUG - request_id: req_9ff682146ac09e6629f2afe9727f44f7
2025-06-06 20:44:39,306 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:44:39,543 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-02f901c4-b28b-4f10-9b71-dde7f28849f0', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:39,545 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:39,691 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-52a45399-ea1c-43d1-9e75-346c8a95b853', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:39,692 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:39,762 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:39,765 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:39 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1403', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1408', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_fd1d4e8736f348a4e3f328b1e3911268', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f438d6e4d13-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:39,766 - openai._base_client - DEBUG - request_id: req_fd1d4e8736f348a4e3f328b1e3911268
2025-06-06 20:44:39,766 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:44:40,121 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-947d6597-e659-4e40-a8bf-ba08d4f3d43e', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:40,123 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:40,311 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-f8733975-e04c-4413-804b-a06413b98a35', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:40,313 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:40,671 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:40,672 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:40 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '856', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '858', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_dd49c27119cc47d239eed9fe49c1802f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f4c5c138fe7-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:40,672 - openai._base_client - DEBUG - request_id: req_dd49c27119cc47d239eed9fe49c1802f
2025-06-06 20:44:40,674 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-526d9f29-8456-499a-857d-bbfa7acdb465', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:40,675 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:44:40,675 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:40,770 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-caad653a-cb46-4564-a46f-7c63eb992682', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:40,774 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:41,021 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:41,022 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:41 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1388', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1395', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_9ad167a4cc30b838df166af435cdcd9c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f4b6d728fb7-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:41,024 - openai._base_client - DEBUG - request_id: req_9ad167a4cc30b838df166af435cdcd9c
2025-06-06 20:44:41,027 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:44:41,269 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:41,270 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:41 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '859', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '864', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_5ad1afe980588c800f57358c26acc749', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f503d338fd3-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:41,270 - openai._base_client - DEBUG - request_id: req_5ad1afe980588c800f57358c26acc749
2025-06-06 20:44:41,273 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:44:41,275 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-bdad2a30-9ab6-45bd-b607-6715ba2eb6e8', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:41,276 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:41,279 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-4fb7d6b4-6768-4c30-b641-2a66dad9b6f8', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:41,282 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:42,112 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:42,117 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:42 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1904', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1912', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_3a39c6aa6e5fa2bbf5df4a42f18c0792', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f4f09004d13-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:42,117 - openai._base_client - DEBUG - request_id: req_3a39c6aa6e5fa2bbf5df4a42f18c0792
2025-06-06 20:44:42,119 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-e20241df-a1bc-4399-934c-bf96fa5b7171', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:42,119 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:44:42,120 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:42,172 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:42,176 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:42 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1418', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1423', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_c973b486d4224704a09038c510531db7', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f5278468fe7-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:42,176 - openai._base_client - DEBUG - request_id: req_c973b486d4224704a09038c510531db7
2025-06-06 20:44:42,177 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:44:42,206 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:42,207 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:42 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '841', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '845', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4998', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '19ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_ebef67429034c939d36eb0ce34317fdb', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f563b148fb7-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:42,207 - openai._base_client - DEBUG - request_id: req_ebef67429034c939d36eb0ce34317fdb
2025-06-06 20:44:42,208 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:44:42,213 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:42,214 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:42 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '850', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '854', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_9bc1849f2413b252d8e6e6d55b204041', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f5648008fd3-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:42,214 - openai._base_client - DEBUG - request_id: req_9bc1849f2413b252d8e6e6d55b204041
2025-06-06 20:44:42,215 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:44:42,317 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:42,321 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:42 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1433', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1438', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_1b6a44f97335dc87af116647155d5ab3', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f531c91304d-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:42,321 - openai._base_client - DEBUG - request_id: req_1b6a44f97335dc87af116647155d5ab3
2025-06-06 20:44:42,322 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:44:42,683 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-220dce62-bfa4-46b3-9e0c-a16ec3ee7507', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:42,684 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:42,710 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-162f7f24-dc69-4419-8523-95c412e1fedb', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:42,711 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:42,720 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-794c91c9-79f3-42a6-a3f6-f98e7240732a', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:42,722 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:42,724 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-eb4a5708-9970-4f79-b030-c82ba0ed9880', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:42,725 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:43,434 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:43,502 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:43 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1117', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1121', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_3183e339c99d5412b4906820db41a814', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f5b7f514d13-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:43,504 - openai._base_client - DEBUG - request_id: req_3183e339c99d5412b4906820db41a814
2025-06-06 20:44:43,505 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:44:43,641 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:43,651 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:43 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '821', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '824', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_caa5cc13eeea82149e6298c59fcccf4d', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f5f38d18fe7-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:43,651 - openai._base_client - DEBUG - request_id: req_caa5cc13eeea82149e6298c59fcccf4d
2025-06-06 20:44:43,655 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:44:43,701 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:43,704 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:43 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '891', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '894', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_d7652b428ac97050415b1fd1d265691f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f5f59968fd3-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:43,704 - openai._base_client - DEBUG - request_id: req_d7652b428ac97050415b1fd1d265691f
2025-06-06 20:44:43,705 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:44:43,749 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:43,750 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:43 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '913', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '916', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_beb68ec6e6043e33c94b6877c3f11f88', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f5f5eb6304d-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:43,751 - openai._base_client - DEBUG - request_id: req_beb68ec6e6043e33c94b6877c3f11f88
2025-06-06 20:44:43,752 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:44:43,770 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:43,771 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:43 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '994', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '997', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_d412c8caf3ac605f07590016033ea6f2', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f5f0cd98fb7-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:43,772 - openai._base_client - DEBUG - request_id: req_d412c8caf3ac605f07590016033ea6f2
2025-06-06 20:44:43,776 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:44:44,008 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-65330b7a-b6a3-4831-babb-68ee992ad0af', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:44,010 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:44,255 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-5a42635a-2431-43d1-bba9-0a9b10e30859', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:44,256 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:44,657 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-4311b6cb-4ebf-44a1-9e24-dd88e4079994', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:44,658 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:44,706 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-476b9e6d-e40b-48d5-82b6-f8b62a30cf98', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:44,707 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:44,778 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-0050194f-49ee-4044-8440-8f33504e3134', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:44,779 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:45,027 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:45,028 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:45 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '919', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '923', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_0a3c7ed157a2f965010868d536990668', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f674d288fb7-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:45,029 - openai._base_client - DEBUG - request_id: req_0a3c7ed157a2f965010868d536990668
2025-06-06 20:44:45,030 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:44:45,636 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:45,640 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:45 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1230', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1246', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_0739f5c5439b3cc3d0ac08cc22c0e1ed', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f68dff44d13-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:45,640 - openai._base_client - DEBUG - request_id: req_0739f5c5439b3cc3d0ac08cc22c0e1ed
2025-06-06 20:44:45,646 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:44:45,736 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:45,739 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:45 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '939', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '942', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_1959c80267f3f7d9d4a17080f42be8eb', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f6b788a8fe7-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:45,740 - openai._base_client - DEBUG - request_id: req_1959c80267f3f7d9d4a17080f42be8eb
2025-06-06 20:44:45,745 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:44:45,892 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:45,894 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:45 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1030', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1034', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_1bec3591444d949dfe9f7977e6edd529', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f6c1ab4304d-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:45,894 - openai._base_client - DEBUG - request_id: req_1bec3591444d949dfe9f7977e6edd529
2025-06-06 20:44:45,895 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:44:45,936 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:45,944 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:45 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1159', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1161', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_1087ea74e41718fd0f07e0e63ba84292', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f6ba8f38fd3-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:45,945 - openai._base_client - DEBUG - request_id: req_1087ea74e41718fd0f07e0e63ba84292
2025-06-06 20:44:45,945 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:44:46,054 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-ed6fad39-cc75-41b0-845e-5750df493476', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:46,059 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:46,649 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-691da8bd-1d7c-473b-841b-61eda2e6509c', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:44:46,651 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:44:47,203 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:47,204 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:47 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1049', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1053', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_d4632e5b7d94fb2b8df7c8d8f2f72f10', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f741f6d8fb7-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:47,204 - openai._base_client - DEBUG - request_id: req_d4632e5b7d94fb2b8df7c8d8f2f72f10
2025-06-06 20:44:47,205 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:44:47,686 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:44:47,689 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:44:47 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '958', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '961', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_a8a010fd428d128b2429547b6763c8df', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc1f77caaa4d13-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:44:47,689 - openai._base_client - DEBUG - request_id: req_a8a010fd428d128b2429547b6763c8df
2025-06-06 20:44:47,691 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:44:47,749 - llm_extraction.batch_processor - INFO - Batch processing complete. 10 records processed.
2025-06-06 20:44:47,749 - __main__ - INFO - Successfully processed 10 records for Beef Chuck
2025-06-06 20:44:47,749 - __main__ - INFO - 📤 Stage 3: Output Generation
2025-06-06 20:44:47,794 - output_generation.file_writer - INFO - Separated data: 0 clean records, 10 flagged records
2025-06-06 20:44:47,850 - output_generation.file_writer - INFO - Written 10 flagged records to outputs/beef_chuck_extracted_flagged.csv
2025-06-06 20:44:47,850 - __main__ - INFO - Output files created: ['Beef Chuck']
2025-06-06 20:44:47,851 - __main__ - INFO - ⏭️ Stage 4: Database Upload (Skipped - use --upload-to-firebase to enable)
2025-06-06 20:44:47,852 - __main__ - INFO - ✅ Pipeline Complete!
2025-06-06 20:44:47,852 - __main__ - INFO - 📊 Summary:
2025-06-06 20:44:47,853 - __main__ - INFO -    Total records processed: 10
2025-06-06 20:44:47,853 - __main__ - INFO -    Records needing review: 10 (100.0%)
2025-06-06 20:44:47,853 - __main__ - INFO -    Average confidence: 0.00
2025-06-06 20:44:47,853 - __main__ - WARNING - Some records need review - check flagged output files
2025-06-06 20:49:07,714 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 20:49:07,714 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 20:49:07,714 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 20:49:07,714 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 20:49:07,715 - __main__ - ERROR - Error processing product query file: name 'pd' is not defined
2025-06-06 20:49:07,715 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 20:49:07,715 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 20:49:07,715 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 20:49:07,715 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 20:49:07,716 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 20:49:07,716 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 20:49:07,868 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:49:07,869 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:49:07,871 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:49:07,871 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:49:07,877 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 20:49:07,878 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 20:49:07,880 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:49:07,880 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:49:07,882 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:49:07,882 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 20:49:07,882 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:49:07,884 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 20:49:07,897 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:49:07,898 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:49:07,905 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:49:07,911 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:49:07,915 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 20:49:07,919 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 20:49:07,930 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description']
2025-06-06 20:49:07,930 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 20:49:07,933 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 20:49:07,982 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 20:49:07,982 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 20:49:07,982 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 20:49:08,108 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:49:08,108 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:49:08,108 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 20:49:08,108 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 20:49:08,175 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 20:49:08,177 - __main__ - INFO - Available categories in data: ['Uncategorized' 'Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground'
 'Miscellaneous Beef' 'Pork Rib' 'Pork Other' 'Rib' 'Beef Flank'
 'Pork Loin' 'Misc. Items' 'Beef Chuck' 'Chicken Misc.'
 'Chicken Airline Breast' 'Ground Beef Anmar Production'
 'Beef Variety & Misc' 'Beef Other' 'Delete Items' 'Beef Rib'
 'Beef Ground' 'Lamb' 'Hot Dogs' 'Beef Round' 'Pork Sausage' 'Beef Loin'
 'Goat' 'Wild Game' 'Veal' 'Halal' 'Supplies' 'Pot Sticker' 'Dim Sum'
 'Beef,Pork-Sausage,Smok' 'Pork Ham/Leg' 'Rabbit' 'DISCONTINUED ITEMS'
 'Pork Butt' 'Chicken Main' 'Pork Variety' 'Ground Beef' 'Poultry Leg'
 'Pork Shoulder' 'Pork Belly' 'Veal Strauss' 'Brisket' 'Chicken Variety'
 'Plate' 'Game Meat' 'Duck' 'Poultry Breast' 'Poultry Whole' 'Turkey'
 'Poultry Drumstick' 'Poultry Thigh' 'Poultry Tender' 'Poultry Wing'
 'Poultry Other' 'Misc' 'Chicken Wings' 'Chicken Leg Meat']
2025-06-06 20:49:08,178 - __main__ - INFO - Category counts: {'Beef Rib': 87, 'Pork Loin': 85, 'Pork Other': 81, 'Beef Flank': 80, 'Beef Chuck': 68, 'Chicken Main': 68, 'Uncategorized': 49, 'Delete Items': 48, 'Pork Rib': 48, 'Poultry Breast': 46, 'Misc': 28, 'Duck': 24, 'Pork Ham/Leg': 23, 'Misc. Items': 18, 'Dim Sum': 18, 'Miscellaneous Beef': 15, 'Goat': 15, 'Ground Beef Anmar Production': 12, 'Pork Shoulder': 12, 'Poultry Ground': 12, 'DISCONTINUED ITEMS': 12, 'Beef,Pork-Sausage,Smok': 12, 'Pork Variety': 11, 'Beef Variety & Misc': 10, 'Beef Ground': 10, 'Plate': 9, 'Poultry Thigh': 9, 'Chicken Leg Meat': 9, 'Beef Loin': 8, 'Lamb': 7, 'Ground Beef': 7, 'Turkey': 6, 'Chicken Variety': 6, 'Wild Game': 6, 'Beef Round': 6, 'Brisket': 6, 'Poultry Whole': 5, 'Poultry Tender': 4, 'Poultry Other': 4, 'Poultry Wing': 4, 'Pork Butt': 4, 'Poultry Leg': 4, 'Poultry Drumstick': 4, 'Pork Belly': 4, 'Veal': 3, 'Chicken Misc.': 3, 'Pork Hams': 3, 'Chicken Wings': 3, 'Rib': 3, 'Veal Strauss': 3, 'Game Meat': 3, 'Chicken Airline Breast': 3, 'Halal': 3, 'Rabbit': 3, 'Pork Sausage': 3, 'Pot Sticker': 3, 'Non Product': 3, 'Supplies': 3, 'Beef Other': 1, 'Sausage': 1, 'Hot Dogs': 1}
2025-06-06 20:49:08,178 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 20:49:08,178 - __main__ - INFO - Found 68 records for Beef Chuck
2025-06-06 20:49:08,179 - __main__ - INFO - Test run: Processing only 10 records
2025-06-06 20:49:08,179 - llm_extraction.batch_processor - INFO - Processing 10 records for Beef Chuck
2025-06-06 20:49:08,312 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-07587dd3-3ced-4b03-b473-e50e18cc5699', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:08,332 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:08,785 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-45236451-fe39-42d1-91f0-45fd9f54dd52', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:08,785 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-b1bd3df2-78ad-4b05-9f29-dcda813701a8', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:08,786 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:08,786 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-60d9c515-cc43-45af-8fd5-3b59cdc1a195', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:08,786 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-4fb36faa-512e-4e48-bec7-5ed654367cac', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:08,787 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:08,787 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:08,788 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:09,380 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:09,383 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:49:09 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '849'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '853'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_3bd8737105bfe972564df58d8b3fb33f'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=ZTZt5gvXgWFJE9xmVCxkEQ8YQwRmlfJ_0FxVdGsxJTc-1749257349-1.0.1.1-rNA74E.sJw_PZ5mfFfgV2KmUAo7bu3k3E2E_JqwyrvaoiThEZ0zS35WKfosVvsE1yfoae3YUs0xobU.x1VPG2HS9YMerZUjCLvF2puw7C9s; path=/; expires=Sat, 07-Jun-25 01:19:09 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=7I4NdVYemJ1BzqPXZhQooz5.DFKBOA90IziIscgwLU8-1749257349372-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc25dbc88c3b6f-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:49:09,383 - openai._base_client - DEBUG - request_id: req_3bd8737105bfe972564df58d8b3fb33f
2025-06-06 20:49:09,390 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:49:09,818 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:09,818 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:49:09 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '858'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '861'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_6be4fc15d7002ce267a026c671a5cc39'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=4Tfw9HAnfwsWfNPQgAvs3elaR6p_yh9KzkBunsu3Ow0-1749257349-1.0.1.1-XfsqTtT5i165mTU16QtcOm_FRy6cfUlY5UJsOBuQ3ZAhES0UZh78h2d7awHx5C5rEbN7wZKqiZ_.I.wi.tBsJznQj.LzQqcSINXgU6aCu44; path=/; expires=Sat, 07-Jun-25 01:19:09 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=OhCjTTiQJ1pZ8cTYz9XJM0SR8XnXvQf7vS.q6YC1TSs-1749257349821-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc25de9aba4d05-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:49:09,818 - openai._base_client - DEBUG - request_id: req_6be4fc15d7002ce267a026c671a5cc39
2025-06-06 20:49:09,819 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:49:09,895 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:09,896 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-221ce5fc-6b82-4014-af1e-106ea63cbc3f', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:09,898 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:09,898 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:49:09 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '912'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '917'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_d395a7ee0b1ad55f5a7dae3d1260b047'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=..MkUCstYWo7nHMHN3gpQH5e1kyQ_XFPOw_3TTmScPA-1749257349-1.0.1.1-eolwNo4Gsn.5YnbZhJ_LeWovi.LFZ2r89MCRzNM_g3YGaOVsggmvmwERpsJHtpdcliD_Mj4iiN2eaJn9MigT8vC.VPp0mFh0e827PossTkE; path=/; expires=Sat, 07-Jun-25 01:19:09 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=shj7IOlq5VQOHcY5z1XcUkYA81ER5HuSSpv6tR6IkNI-1749257349913-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc25de9de68fdb-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:49:09,898 - openai._base_client - DEBUG - request_id: req_d395a7ee0b1ad55f5a7dae3d1260b047
2025-06-06 20:49:09,899 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:49:10,118 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:10,133 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:49:10 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1089'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1094'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_6ee6fa64eb50f80287b48c2ae73a109a'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=.5us9XdFkObcybp.fzFNtvuQAzPlYaWKeOemH9baPzc-1749257350-1.0.1.1-Sq5oV_ZEjdMibe9pZXXgOjqqh4zxGXK4r1gDDPQjuUN1JgYUGSXecy5qpuUoeUdKkVkpseOY5YGsufQ3E98nwsSrEK5YLg1y21._MNrp7TE; path=/; expires=Sat, 07-Jun-25 01:19:10 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=WKS.0Iysow.5q_AT9t.scdkw.Tnl6G_u2ibTuhNMiUc-1749257350130-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc25dea8d74ce8-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:49:10,136 - openai._base_client - DEBUG - request_id: req_6ee6fa64eb50f80287b48c2ae73a109a
2025-06-06 20:49:10,136 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:49:10,322 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-ee32417b-babc-4eac-b284-17744d096755', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:10,322 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:10,401 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-addbcb22-450e-4da4-b054-52bd1d51f8e3', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:10,402 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:10,669 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-6dbc0996-da00-404c-b12a-2805bf277aa9', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:10,676 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:10,833 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:10,833 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:49:10 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1809'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1884'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_603ec2657aeffc6df9794ebe6b105714'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=lbK6QwApa1rzC6wm6eOAOT7gv203icfH81.ZOnySSeY-1749257350-1.0.1.1-Mn9.E6l_qQR3saY1HnQSJi3gfAgDXnQCdLsJeU1haWOaB4UT_HhuInN0G5nolrPZWIiWwV91BEdUPVEcG2k2mRqbtyoOl6HZNnDZmGBmwQk; path=/; expires=Sat, 07-Jun-25 01:19:10 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=4EJJvtLcvewXBZTUpVybdgru9YWpamRWRPtsko55pFo-1749257350840-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc25de9fdd8fc4-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:49:10,833 - openai._base_client - DEBUG - request_id: req_603ec2657aeffc6df9794ebe6b105714
2025-06-06 20:49:10,834 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:49:11,334 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-13ea3320-fcb8-4be1-844b-02db52a019a1', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:11,335 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:11,426 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:11,426 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:11 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1028', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1033', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_05792d3ac750b1175033d78cc66d4b24', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc25e7bc0d8fdb-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:11,426 - openai._base_client - DEBUG - request_id: req_05792d3ac750b1175033d78cc66d4b24
2025-06-06 20:49:11,427 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:49:11,794 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:11,795 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:11 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1704', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1799', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_01599ad0f5cd1f3b6e9ea49509d7ad56', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc25e528733b6f-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:11,796 - openai._base_client - DEBUG - request_id: req_01599ad0f5cd1f3b6e9ea49509d7ad56
2025-06-06 20:49:11,796 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:49:11,969 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:11,974 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:11 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1465', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1473', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_ead179b54beccef161004b6539bc3d53', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc25e85e814ce8-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:11,976 - openai._base_client - DEBUG - request_id: req_ead179b54beccef161004b6539bc3d53
2025-06-06 20:49:11,977 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:49:12,441 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:12,443 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-420afa48-0075-4f14-a09f-55d8892acde9', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:12,455 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:12,456 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:12 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '964', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '968', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_116999642c9ee51da4189665880ab183', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc25ee3d478fc4-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:12,461 - openai._base_client - DEBUG - request_id: req_116999642c9ee51da4189665880ab183
2025-06-06 20:49:12,462 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:49:12,799 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-73387eaa-7e4b-4271-99e0-dd4f2f75df15', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:12,799 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:12,890 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:12,892 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:12 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1026', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '2117', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_0cd3784a6f1a543c3582b42c4e2a8f81', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc25ea1e404d05-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:12,892 - openai._base_client - DEBUG - request_id: req_0cd3784a6f1a543c3582b42c4e2a8f81
2025-06-06 20:49:12,892 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:49:12,985 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-aebc4ce7-8740-4522-a4a3-c968d0b94366', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:12,990 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:13,446 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:13,446 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:13 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '876', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '879', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_579384809a002a71b6cd98fb76c31b32', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc25f54dfa3b6f-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:13,447 - openai._base_client - DEBUG - request_id: req_579384809a002a71b6cd98fb76c31b32
2025-06-06 20:49:13,448 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:49:13,448 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-5231844d-fb06-4246-a99a-d8ac1d66ee0b', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:13,448 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:13,466 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-a4b7f20f-4ddb-4949-837c-69bd34edda9c', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:13,466 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:13,894 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-c12ba6b2-b089-4a57-b2ba-0c8b7cb43c5e', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:13,895 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:13,905 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:13,905 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:13 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1020', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1031', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_01acdf1ad2817d63c7adb260f1a14d0a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc25f738778fdb-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:13,905 - openai._base_client - DEBUG - request_id: req_01acdf1ad2817d63c7adb260f1a14d0a
2025-06-06 20:49:13,906 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:49:14,052 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-c4f05d60-55c0-4dc3-8467-38523e0c9f49', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:14,052 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:14,091 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:14,109 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1019', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1025', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_8a64a131d657b195d42f8b24c2be31f4', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc25f86e364ce8-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:14,109 - openai._base_client - DEBUG - request_id: req_8a64a131d657b195d42f8b24c2be31f4
2025-06-06 20:49:14,109 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:49:14,498 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:14,499 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:14,499 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '870', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '874', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_1cdad4339da5ac6a92413e2e0b71cd9e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc25fb6be48fc4-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:14,499 - openai._base_client - DEBUG - request_id: req_1cdad4339da5ac6a92413e2e0b71cd9e
2025-06-06 20:49:14,499 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '901', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '905', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_ea42fd6a395d84ea5519a2e1ed3051e6', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc25fb497b3b6f-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:14,500 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:49:14,500 - openai._base_client - DEBUG - request_id: req_ea42fd6a395d84ea5519a2e1ed3051e6
2025-06-06 20:49:14,500 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:49:14,653 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-af1f14aa-037f-450b-9a8c-49a839b611c8', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:14,653 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-c1e1a777-a9e4-4c9d-968f-dd54861393f9', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:14,654 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:14,654 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:14,793 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:14,797 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '761', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '764', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_cc70ec2133c59634438b1eb72fa2971b', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc25fe1e5b4d05-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:14,800 - openai._base_client - DEBUG - request_id: req_cc70ec2133c59634438b1eb72fa2971b
2025-06-06 20:49:14,803 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:49:15,011 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-a73103b5-7207-4aa6-9332-4f5edb4bc858', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:15,019 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:15,248 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:15,253 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:15 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1125', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1130', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_ebe1838437f88ee02afd8867c4152af2', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc25ff0a2e8fdb-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:15,253 - openai._base_client - DEBUG - request_id: req_ebe1838437f88ee02afd8867c4152af2
2025-06-06 20:49:15,253 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:49:15,257 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-64fdee4d-ebc8-4c7a-96e9-34dfac3083a6', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:15,257 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:15,719 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:15,719 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:15 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '950', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '957', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_d6338569ce6fc6d501d2c2aad01c6270', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc2602c8c24ce8-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:15,719 - openai._base_client - DEBUG - request_id: req_d6338569ce6fc6d501d2c2aad01c6270
2025-06-06 20:49:15,720 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:49:15,754 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-87cbaa88-0881-41b7-8eb6-8333bad216c8', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:15,755 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:16,202 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:16,203 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '855', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '860', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_7749e1bc430df22dfe96044856e2d965', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc26069b4b8fdb-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:16,203 - openai._base_client - DEBUG - request_id: req_7749e1bc430df22dfe96044856e2d965
2025-06-06 20:49:16,203 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:49:16,220 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-8abcbcb0-2fe9-4451-9a99-66b39de9e175', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:16,220 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:16,661 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:16,667 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '804', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '806', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_58ad5f0accd0564ed9a18ee7cf2e4a40', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc2609be384ce8-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:16,670 - openai._base_client - DEBUG - request_id: req_58ad5f0accd0564ed9a18ee7cf2e4a40
2025-06-06 20:49:16,670 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:49:16,705 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-fea3f65c-b95c-4145-9285-705ea4ea1cfd', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:16,705 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:16,815 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:16,816 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '2057', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '2064', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_97368888f095367c710292b32dd21fb1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc2602cf5d3b6f-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:16,816 - openai._base_client - DEBUG - request_id: req_97368888f095367c710292b32dd21fb1
2025-06-06 20:49:16,816 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:49:17,160 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:17,174 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:17 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '793', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '797', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_a38ed958fd058fd788566146e7e9f46e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc260ca93a8fdb-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:17,174 - openai._base_client - DEBUG - request_id: req_a38ed958fd058fd788566146e7e9f46e
2025-06-06 20:49:17,176 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:49:17,323 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-64795719-ad22-4643-8905-5fb2384a5953', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:17,327 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:17,673 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-0ff47204-38aa-44f1-98c1-8bf2313bec03', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:17,674 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:17,699 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:17,699 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:17 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '915', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '919', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_b56696ef856ff2a5a01333ba273d9e96', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc260fa93a4ce8-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:17,699 - openai._base_client - DEBUG - request_id: req_b56696ef856ff2a5a01333ba273d9e96
2025-06-06 20:49:17,700 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:49:18,182 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-eaacc56b-b092-4403-b09c-f6e7f7f6399e', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:18,183 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:18,497 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:18,501 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1080', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1085', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_614d76109ce1db2c11eca85df412dfd2', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc26139d413b6f-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:18,502 - openai._base_client - DEBUG - request_id: req_614d76109ce1db2c11eca85df412dfd2
2025-06-06 20:49:18,502 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:49:18,583 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:18,584 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '810', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '812', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_01f540b51f3367eaa6150d46319d6820', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc2615de188fdb-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:18,584 - openai._base_client - DEBUG - request_id: req_01f540b51f3367eaa6150d46319d6820
2025-06-06 20:49:18,585 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:49:18,686 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:18,687 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1097', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '3579', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_645fe856a00b22fba338abfb27945c6f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc26051c658fc4-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:18,687 - openai._base_client - DEBUG - request_id: req_645fe856a00b22fba338abfb27945c6f
2025-06-06 20:49:18,688 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:49:18,703 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-c1f82609-3dc7-4684-8aaa-4efa43dd124b', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:18,704 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:19,508 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-443ef977-04b6-4279-9d45-ee665467ecc7', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:19,510 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:19,695 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-a856c70a-d7f2-49e5-8fe1-ad3ae2970a09', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:49:19,696 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:49:19,866 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:19,873 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:19 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1606', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1612', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_3177d75f9917c771f81ea1fd059d49a0', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc2618ea134ce8-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:19,873 - openai._base_client - DEBUG - request_id: req_3177d75f9917c771f81ea1fd059d49a0
2025-06-06 20:49:19,874 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:49:21,234 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:21,235 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:21 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1657', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1660', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_6e711dff88e953d9cdb255bb5737a175', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc262128368fdb-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:21,235 - openai._base_client - DEBUG - request_id: req_6e711dff88e953d9cdb255bb5737a175
2025-06-06 20:49:21,235 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:49:21,406 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:21,407 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:21 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '2628', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '2632', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_9a7f7e9c0c9c93c9805dd3ab134d66f1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc261c2d163b6f-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:21,407 - openai._base_client - DEBUG - request_id: req_9a7f7e9c0c9c93c9805dd3ab134d66f1
2025-06-06 20:49:21,407 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:49:21,621 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:49:21,622 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:49:21 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1790', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1796', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_a70e970b045ae5caa7054959c61cd451', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc26225f478fc4-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:49:21,622 - openai._base_client - DEBUG - request_id: req_a70e970b045ae5caa7054959c61cd451
2025-06-06 20:49:21,622 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:49:21,628 - llm_extraction.batch_processor - INFO - Batch processing complete. 10 records processed.
2025-06-06 20:49:21,628 - __main__ - INFO - Successfully processed 10 records for Beef Chuck
2025-06-06 20:49:21,629 - __main__ - INFO - 📤 Stage 3: Output Generation
2025-06-06 20:49:21,631 - output_generation.file_writer - INFO - Separated data: 0 clean records, 10 flagged records
2025-06-06 20:49:21,634 - output_generation.file_writer - INFO - Written 10 flagged records to outputs/beef_chuck_extracted_flagged.csv
2025-06-06 20:49:21,634 - __main__ - INFO - Output files created: ['Beef Chuck']
2025-06-06 20:49:21,635 - __main__ - INFO - ⏭️ Stage 4: Database Upload (Skipped - use --upload-to-firebase to enable)
2025-06-06 20:49:21,635 - __main__ - INFO - ✅ Pipeline Complete!
2025-06-06 20:49:21,635 - __main__ - INFO - 📊 Summary:
2025-06-06 20:49:21,635 - __main__ - INFO -    Total records processed: 10
2025-06-06 20:49:21,635 - __main__ - INFO -    Records needing review: 10 (100.0%)
2025-06-06 20:49:21,635 - __main__ - INFO -    Average confidence: 0.00
2025-06-06 20:49:21,635 - __main__ - WARNING - Some records need review - check flagged output files
2025-06-06 20:50:21,172 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 20:50:21,172 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 20:50:21,172 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 20:50:21,172 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 20:50:21,172 - __main__ - ERROR - Error processing product query file: name 'pd' is not defined
2025-06-06 20:50:21,172 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 20:50:21,173 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 20:50:21,173 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 20:50:21,173 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 20:50:21,173 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 20:50:21,174 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 20:50:21,348 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:50:21,348 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:50:21,349 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:50:21,349 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:50:21,357 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 20:50:21,359 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 20:50:21,361 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:50:21,361 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:50:21,362 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:50:21,362 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:50:21,363 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 20:50:21,363 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 20:50:21,383 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:50:21,385 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:50:21,386 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:50:21,391 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:50:21,396 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 20:50:21,399 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 20:50:21,413 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description']
2025-06-06 20:50:21,414 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 20:50:21,417 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 20:50:21,465 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 20:50:21,465 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 20:50:21,466 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 20:50:21,605 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:50:21,605 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:50:21,605 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 20:50:21,605 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 20:50:21,666 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 20:50:21,667 - __main__ - INFO - Available categories in data: ['Uncategorized' 'Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground'
 'Miscellaneous Beef' 'Pork Rib' 'Pork Other' 'Rib' 'Beef Flank'
 'Pork Loin' 'Misc. Items' 'Beef Chuck' 'Chicken Misc.'
 'Chicken Airline Breast' 'Ground Beef Anmar Production'
 'Beef Variety & Misc' 'Beef Other' 'Delete Items' 'Beef Rib'
 'Beef Ground' 'Lamb' 'Hot Dogs' 'Beef Round' 'Pork Sausage' 'Beef Loin'
 'Goat' 'Wild Game' 'Veal' 'Halal' 'Supplies' 'Pot Sticker' 'Dim Sum'
 'Beef,Pork-Sausage,Smok' 'Pork Ham/Leg' 'Rabbit' 'DISCONTINUED ITEMS'
 'Pork Butt' 'Chicken Main' 'Pork Variety' 'Ground Beef' 'Poultry Leg'
 'Pork Shoulder' 'Pork Belly' 'Veal Strauss' 'Brisket' 'Chicken Variety'
 'Plate' 'Game Meat' 'Duck' 'Poultry Breast' 'Poultry Whole' 'Turkey'
 'Poultry Drumstick' 'Poultry Thigh' 'Poultry Tender' 'Poultry Wing'
 'Poultry Other' 'Misc' 'Chicken Wings' 'Chicken Leg Meat']
2025-06-06 20:50:21,667 - __main__ - INFO - Category counts: {'Beef Rib': 87, 'Pork Loin': 85, 'Pork Other': 81, 'Beef Flank': 80, 'Beef Chuck': 68, 'Chicken Main': 68, 'Uncategorized': 49, 'Delete Items': 48, 'Pork Rib': 48, 'Poultry Breast': 46, 'Misc': 28, 'Duck': 24, 'Pork Ham/Leg': 23, 'Misc. Items': 18, 'Dim Sum': 18, 'Miscellaneous Beef': 15, 'Goat': 15, 'Ground Beef Anmar Production': 12, 'Pork Shoulder': 12, 'Poultry Ground': 12, 'DISCONTINUED ITEMS': 12, 'Beef,Pork-Sausage,Smok': 12, 'Pork Variety': 11, 'Beef Variety & Misc': 10, 'Beef Ground': 10, 'Plate': 9, 'Poultry Thigh': 9, 'Chicken Leg Meat': 9, 'Beef Loin': 8, 'Lamb': 7, 'Ground Beef': 7, 'Turkey': 6, 'Chicken Variety': 6, 'Wild Game': 6, 'Beef Round': 6, 'Brisket': 6, 'Poultry Whole': 5, 'Poultry Tender': 4, 'Poultry Other': 4, 'Poultry Wing': 4, 'Pork Butt': 4, 'Poultry Leg': 4, 'Poultry Drumstick': 4, 'Pork Belly': 4, 'Veal': 3, 'Chicken Misc.': 3, 'Pork Hams': 3, 'Chicken Wings': 3, 'Rib': 3, 'Veal Strauss': 3, 'Game Meat': 3, 'Chicken Airline Breast': 3, 'Halal': 3, 'Rabbit': 3, 'Pork Sausage': 3, 'Pot Sticker': 3, 'Non Product': 3, 'Supplies': 3, 'Beef Other': 1, 'Sausage': 1, 'Hot Dogs': 1}
2025-06-06 20:50:21,668 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 20:50:21,668 - __main__ - INFO - Found 68 records for Beef Chuck
2025-06-06 20:50:21,669 - __main__ - INFO - Test run: Processing only 10 records
2025-06-06 20:50:21,669 - llm_extraction.batch_processor - INFO - Processing 10 records for Beef Chuck
2025-06-06 20:50:21,819 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-113ee187-f88a-4646-bf63-edea99c4ce90', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:21,843 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:22,274 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-543684e6-4d71-43da-8e0c-f82e399c5dcf', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:22,274 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-13009a07-c084-4f7b-88ec-3f93a26dbf45', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:22,274 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-fab9d2a8-577d-4820-a0de-78b22f96a14c', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:22,274 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-871da1ad-bc31-4516-8d18-18a434babf27', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:22,275 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:22,275 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:22,275 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:22,276 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:23,188 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:23,232 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:50:23 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1131'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1135'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_20aef9e977826ccb54ffbd1ab262b5e2'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=0JFqjZumBpRDoI2of2YmOndeyaVvgCO_9FmIVcIve_4-1749257423-1.0.1.1-4gH3y975UUzmBN4eqfPhhgWe667tJMFxarYAQr_EOnAetakJ.frvJ1PpbbmmydvV43gt6sbPf.T3Tee4MGBXWCoyC2N3DTGipK4XGlExlpA; path=/; expires=Sat, 07-Jun-25 01:20:23 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=XbxhAVoUy0xSLwUXBQJc9odfcM6OGbHqz7YcrGmC8n8-1749257423192-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc27a73af03074-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:50:23,240 - openai._base_client - DEBUG - request_id: req_20aef9e977826ccb54ffbd1ab262b5e2
2025-06-06 20:50:23,259 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:50:23,768 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-0d05a458-ace1-4bb9-9ed5-1181c4a762a8', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:23,771 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:23,871 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:23,875 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:50:23 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1399'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1401'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_084bfd76d37afeaa88d7e4135acbaf59'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=aNK2Phot.QDuLud2dnpmZBO0cb3bGvaBVmbbRZr8AV8-1749257423-1.0.1.1-z14CmLpMTfu.ea71oDjrBP6uWPGwlr_sJa2ImRCoIlReOcsWkrqoZygLn2c.3PjLNAjJmZMVp4oRLQTjIA5a1rBnHnOJHto8p9Jh93snzBQ; path=/; expires=Sat, 07-Jun-25 01:20:23 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=hmLgzU6XzCmnwe3cH3BTBCBadS0AaMLvaubnJ6xDg1A-1749257423872-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc27aa0b4f3059-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:50:23,904 - openai._base_client - DEBUG - request_id: req_084bfd76d37afeaa88d7e4135acbaf59
2025-06-06 20:50:23,905 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:50:23,942 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:23,950 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:50:23 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1342'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1343'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_a4507b10f7d14bd412d0f67fe202a2ee'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=_SD9lPfqP.AJ_GuVGgNWrH32Rxf6OA6t1anN6ro1udA-1749257423-1.0.1.1-lS.N4IqgIvRi8lpJldMRQxrEqz_2FGDPzHEpS1HvtAQKusHnqwjyXBI1fH8wqrZhSdHosURduhb.1p0PSxFL8Q4tlXt7DjXZ03G0Rue8JBM; path=/; expires=Sat, 07-Jun-25 01:20:23 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=p77qea9Fxb4zZj4KA_Ec__n9Nc2EG48Idzqy20XjCj0-1749257423871-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc27aa4c864d0e-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:50:23,998 - openai._base_client - DEBUG - request_id: req_a4507b10f7d14bd412d0f67fe202a2ee
2025-06-06 20:50:24,002 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:50:24,090 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:24,190 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:50:24 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1509'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1558'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999729'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_51d663e40606b1c55b30c9d1da4ff3a0'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=IGbVXb6v_hg_85lCNhqKmYfhxgHpNJBXxbdoXOlXQZ8-1749257424-1.0.1.1-8qJrSuy3.ZYxuMoFKrRL4M1XpGDLKNlarp9RLwXvoFkRUlSP_Qi26v5k_sQd5hV7_uHey_t9wrudlF9tDy.5ouM1lzL.9pmryr__b2nQd2I; path=/; expires=Sat, 07-Jun-25 01:20:24 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=vAs5D8RuuBjfBpEzsa2guqOYVSSsq0Q.ySD1ollnMJQ-1749257424064-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc27aa4d5c906b-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:50:24,203 - openai._base_client - DEBUG - request_id: req_51d663e40606b1c55b30c9d1da4ff3a0
2025-06-06 20:50:24,205 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:50:24,307 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:24,317 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 00:50:24 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1798'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1804'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4998'), ('x-ratelimit-remaining-tokens', '3999578'), ('x-ratelimit-reset-requests', '22ms'), ('x-ratelimit-reset-tokens', '6ms'), ('x-request-id', 'req_1092982c3b92e8d9875b9852647ad655'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=8RoSBfcsqnxvnXJCiH8YZMbGPL7mQBslLhMMJzGpGFs-1749257424-1.0.1.1-BnTwMuGw5HBeLpakJt2zg8PBBmhdHBZ0m0MJ19k10UJfGvH2OqtpvSB_LpjP_FbsACJvptHgp64nMzx5oOt7o.MPOPiG2yrU9oj1QT2Ikbo; path=/; expires=Sat, 07-Jun-25 01:20:24 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Qbj3tRn1_O.MJerNAPqRjYBjVdI0ihqIMk8Y8xjA2vs-1749257424310-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc27aa4e848fa2-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 20:50:24,330 - openai._base_client - DEBUG - request_id: req_1092982c3b92e8d9875b9852647ad655
2025-06-06 20:50:24,332 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:50:24,410 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-3fd7bdad-7bd0-446e-a8ee-a327fb97c41b', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:24,415 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:24,507 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-7bb8c32b-48c5-4c28-b154-57c75aa5297f', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:24,508 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:24,707 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-b22470ed-4f38-413f-926c-f362f4d6e01e', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:24,708 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:24,846 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-7012a031-250b-4817-8c29-41379fab595f', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:24,848 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:24,884 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:24,885 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:24 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '998', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1004', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_85129eb90d38816eae15fead17074109', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27b30c763074-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:24,886 - openai._base_client - DEBUG - request_id: req_85129eb90d38816eae15fead17074109
2025-06-06 20:50:24,887 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:50:25,408 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:25,410 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:25 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '903', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '908', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_5ea2eb2ea753b79d0fd2225eb0c3f926', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27b6ea1f3059-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:25,411 - openai._base_client - DEBUG - request_id: req_5ea2eb2ea753b79d0fd2225eb0c3f926
2025-06-06 20:50:25,411 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:50:25,899 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-63520ee8-243e-4c23-b0a9-f2fc18a517bd', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:25,958 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:25,966 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:25,972 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:25 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1036', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1039', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_a79980c3d7f32af901dcef9b5d66320e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27b98f4b8fa2-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:25,973 - openai._base_client - DEBUG - request_id: req_a79980c3d7f32af901dcef9b5d66320e
2025-06-06 20:50:25,975 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:50:26,238 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:26,245 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:26 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1642', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1645', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_ac28530fe52c5643988935257bd8435a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27b769754d0e-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:26,246 - openai._base_client - DEBUG - request_id: req_ac28530fe52c5643988935257bd8435a
2025-06-06 20:50:26,247 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:50:26,417 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-7961d3bd-74e8-44fe-a851-c84eb6534d38', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:26,418 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:26,980 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-c0fcf454-b268-4a0c-b7cf-c4d8eba1a12c', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:26,981 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:27,094 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:27,095 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:27 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '972', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '976', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_c9f222f181c97a95232f7597b0e01f48', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27c088b93074-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:27,095 - openai._base_client - DEBUG - request_id: req_c9f222f181c97a95232f7597b0e01f48
2025-06-06 20:50:27,097 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:50:27,097 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-51810553-b6ff-4507-b334-daa18eb5cc40', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:27,098 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:27,225 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:27,251 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-3116f015-701f-48ac-b1fd-a3305e2c6458', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:27,252 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:27,278 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:27 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '615', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '618', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_8ded9efa067812383c60abbf10ddf633', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27c39f463059-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:27,280 - openai._base_client - DEBUG - request_id: req_8ded9efa067812383c60abbf10ddf633
2025-06-06 20:50:27,282 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:50:27,701 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-2c23fbf0-e2a8-4ea5-841b-1f88d875bebe', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:27,702 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:28,021 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:28,021 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:28 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '818', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '821', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_d1a0cf7b3ef7c51288d8eb9da1388729', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27c7acd63074-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:28,022 - openai._base_client - DEBUG - request_id: req_d1a0cf7b3ef7c51288d8eb9da1388729
2025-06-06 20:50:28,023 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:50:28,102 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:28,102 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:28 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1020', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1027', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_e3d35fedfaa60b269540471ba9e60984', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27c6e9104d0e-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:28,103 - openai._base_client - DEBUG - request_id: req_e3d35fedfaa60b269540471ba9e60984
2025-06-06 20:50:28,104 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:50:28,182 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:28,195 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:28 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '845', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '848', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_9d94fa53d59c7b98baab6fe1493092d5', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27c89ea98fa2-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:28,197 - openai._base_client - DEBUG - request_id: req_9d94fa53d59c7b98baab6fe1493092d5
2025-06-06 20:50:28,240 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:50:28,304 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-d87abdb6-cf98-49e5-8cd8-624e52c0558b', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:28,314 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-7d64d693-bf4f-4827-9cc6-6846f324ccd7', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:28,334 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:28,369 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:28,527 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-701a072c-79f4-4a7d-9567-e713b3dbee1e', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:28,528 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:28,740 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:28,741 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:28 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '956', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '959', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_305a37fe6bf3f2916196724e7e737916', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27cb5b223059-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:28,741 - openai._base_client - DEBUG - request_id: req_305a37fe6bf3f2916196724e7e737916
2025-06-06 20:50:28,742 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:50:29,251 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-a33ccf9c-6cb7-4818-88de-38b734c32c83', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:29,267 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:29,322 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:29,323 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:29 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '808', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '813', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_cee6278c4cd7cbc91d70604eafe0acc6', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27cfdee34d0e-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:29,324 - openai._base_client - DEBUG - request_id: req_cee6278c4cd7cbc91d70604eafe0acc6
2025-06-06 20:50:29,324 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:50:29,339 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:29,343 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:29 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '747', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '749', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_e10b7abae2d79da20a73728149a857c0', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27d088bd8fa2-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:29,343 - openai._base_client - DEBUG - request_id: req_e10b7abae2d79da20a73728149a857c0
2025-06-06 20:50:29,344 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:50:29,624 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:29,625 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:29 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1153', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1157', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_77a1aeea85d36d12f29853be5229f5a8', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27cfba023074-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:29,625 - openai._base_client - DEBUG - request_id: req_77a1aeea85d36d12f29853be5229f5a8
2025-06-06 20:50:29,626 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:50:29,861 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-c56ab0a9-5af8-44a6-8518-16ce527970be', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:29,872 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:30,138 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-a0c7a965-126d-40cf-80e8-55db05b71104', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:30,149 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:30,346 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-4b53be55-43e0-43f1-b0bf-5f79814b9a19', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:30,346 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:30,347 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:30,351 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:30 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '989', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '993', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_dd94df7e0836f8af9a80e0a8cde8d3ee', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27d54a863059-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:30,351 - openai._base_client - DEBUG - request_id: req_dd94df7e0836f8af9a80e0a8cde8d3ee
2025-06-06 20:50:30,352 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:50:30,768 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:30,804 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:30 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '806', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '810', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_0be2bfdcc63635fc6175ebb49617fa00', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27d909b33074-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:30,816 - openai._base_client - DEBUG - request_id: req_0be2bfdcc63635fc6175ebb49617fa00
2025-06-06 20:50:30,828 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:50:31,152 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:31,188 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:31 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '891', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '894', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_c0a560fc81148da57620468840cde966', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27dab86d4d0e-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:31,194 - openai._base_client - DEBUG - request_id: req_c0a560fc81148da57620468840cde966
2025-06-06 20:50:31,224 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:50:31,354 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-0b33bc2e-91bf-4a89-8c64-d43627b9c048', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:31,355 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:31,360 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:31,364 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:31 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '930', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '938', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_a31ddb0df0e9c220507c87309aef5454', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27dbf9238fa2-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:31,365 - openai._base_client - DEBUG - request_id: req_a31ddb0df0e9c220507c87309aef5454
2025-06-06 20:50:31,366 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-40b8b628-5a54-4651-a2a5-2239dd517fe3', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:31,367 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:50:31,367 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:31,534 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:31,535 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:31 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '6654', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '6735', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_c58b1528d4876a3c98ca6f56f140de7a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27b8ab6e906b-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:31,535 - openai._base_client - DEBUG - request_id: req_c58b1528d4876a3c98ca6f56f140de7a
2025-06-06 20:50:31,536 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:50:31,841 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-14ab3c21-3a31-49f4-9632-8d7966130f8d', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:31,852 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:32,239 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-cd673a53-e06f-4e43-99d3-b777b9df0279', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:32,240 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:32,321 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:32,322 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:32 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '868', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '874', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_566af1816207e9fedbbccd51c8607644', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27e258d43059-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:32,322 - openai._base_client - DEBUG - request_id: req_566af1816207e9fedbbccd51c8607644
2025-06-06 20:50:32,323 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 20:50:32,337 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:32,338 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:32 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '910', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '913', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_1091e3e16fe9b2f9ffb8274cdd759576', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27e238543074-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:32,338 - openai._base_client - DEBUG - request_id: req_1091e3e16fe9b2f9ffb8274cdd759576
2025-06-06 20:50:32,339 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:50:32,542 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-2059b6b9-ed0c-4988-9115-d57f33c8e263', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:32,558 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:32,792 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:32,806 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:32 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '792', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '796', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_dc6bf53a44086614441a0edb519d6310', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27e57a1a4d0e-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:32,815 - openai._base_client - DEBUG - request_id: req_dc6bf53a44086614441a0edb519d6310
2025-06-06 20:50:32,818 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:50:32,831 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-f6d7579a-24ba-41e1-9b52-c2b5189e6502', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:32,832 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:33,187 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:33,188 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:33 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '769', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '772', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_4a38eba9c190fe3e2a5e89cd2c710647', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27e849cb906b-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:33,188 - openai._base_client - DEBUG - request_id: req_4a38eba9c190fe3e2a5e89cd2c710647
2025-06-06 20:50:33,189 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:50:33,477 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:33,478 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:33 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '842', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '844', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_aa449f1ff39725a000c3dc0fe77217c1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27e9bc013074-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:33,478 - openai._base_client - DEBUG - request_id: req_aa449f1ff39725a000c3dc0fe77217c1
2025-06-06 20:50:33,479 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:50:33,940 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:33,976 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:33 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '952', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '956', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_f5356dda43cf6f69aa2bb212d8c84cf4', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27eb78b33059-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:33,991 - openai._base_client - DEBUG - request_id: req_f5356dda43cf6f69aa2bb212d8c84cf4
2025-06-06 20:50:33,992 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 20:50:34,997 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-3b6b9b93-5f83-4f57-abe9-083ee2aeac69', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:50:34,999 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:50:35,978 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 20:50:35,979 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 00:50:35 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '858', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '862', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999729', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_46f56f13329d64980cb103e0ff3e18c2', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc27f8fdff3074-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 20:50:35,980 - openai._base_client - DEBUG - request_id: req_46f56f13329d64980cb103e0ff3e18c2
2025-06-06 20:50:35,980 - llm_extraction.batch_processor - ERROR - Failed to process record: 'NoneType' object is not subscriptable
2025-06-06 20:50:35,987 - llm_extraction.batch_processor - INFO - Batch processing complete. 10 records processed.
2025-06-06 20:50:35,987 - __main__ - INFO - Successfully processed 10 records for Beef Chuck
2025-06-06 20:50:35,987 - __main__ - INFO - 📤 Stage 3: Output Generation
2025-06-06 20:50:35,991 - output_generation.file_writer - INFO - Separated data: 0 clean records, 10 flagged records
2025-06-06 20:50:35,996 - output_generation.file_writer - INFO - Written 10 flagged records to outputs/beef_chuck_extracted_flagged.csv
2025-06-06 20:50:35,996 - __main__ - INFO - Output files created: ['Beef Chuck']
2025-06-06 20:50:35,996 - __main__ - INFO - ⏭️ Stage 4: Database Upload (Skipped - use --upload-to-firebase to enable)
2025-06-06 20:50:35,996 - __main__ - INFO - ✅ Pipeline Complete!
2025-06-06 20:50:35,996 - __main__ - INFO - 📊 Summary:
2025-06-06 20:50:35,996 - __main__ - INFO -    Total records processed: 10
2025-06-06 20:50:35,996 - __main__ - INFO -    Records needing review: 10 (100.0%)
2025-06-06 20:50:35,996 - __main__ - INFO -    Average confidence: 0.00
2025-06-06 20:50:35,996 - __main__ - WARNING - Some records need review - check flagged output files
2025-06-06 20:53:17,899 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 20:53:17,899 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 20:53:17,899 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 20:53:17,899 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 20:53:17,899 - __main__ - ERROR - Error processing product query file: name 'pd' is not defined
2025-06-06 20:53:17,899 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 20:53:17,900 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 20:53:17,900 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 20:53:17,900 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 20:53:17,900 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 20:53:17,900 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 20:53:18,051 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:53:18,051 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:53:18,051 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:53:18,052 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:53:18,058 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 20:53:18,059 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 20:53:18,060 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:53:18,061 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:53:18,061 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:53:18,062 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:53:18,062 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 20:53:18,062 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 20:53:18,073 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:53:18,073 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:53:18,084 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:53:18,090 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:53:18,095 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 20:53:18,096 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 20:53:18,108 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description']
2025-06-06 20:53:18,109 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 20:53:18,112 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 20:53:18,171 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 20:53:18,171 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 20:53:18,171 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 20:53:18,299 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:53:18,299 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:53:18,299 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 20:53:18,299 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 20:53:18,368 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 20:53:18,370 - __main__ - INFO - Available categories in data: ['Uncategorized' 'Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground'
 'Miscellaneous Beef' 'Pork Rib' 'Pork Other' 'Rib' 'Beef Flank'
 'Pork Loin' 'Misc. Items' 'Beef Chuck' 'Chicken Misc.'
 'Chicken Airline Breast' 'Ground Beef Anmar Production'
 'Beef Variety & Misc' 'Beef Other' 'Delete Items' 'Beef Rib'
 'Beef Ground' 'Lamb' 'Hot Dogs' 'Beef Round' 'Pork Sausage' 'Beef Loin'
 'Goat' 'Wild Game' 'Veal' 'Halal' 'Supplies' 'Pot Sticker' 'Dim Sum'
 'Beef,Pork-Sausage,Smok' 'Pork Ham/Leg' 'Rabbit' 'DISCONTINUED ITEMS'
 'Pork Butt' 'Chicken Main' 'Pork Variety' 'Ground Beef' 'Poultry Leg'
 'Pork Shoulder' 'Pork Belly' 'Veal Strauss' 'Brisket' 'Chicken Variety'
 'Plate' 'Game Meat' 'Duck' 'Poultry Breast' 'Poultry Whole' 'Turkey'
 'Poultry Drumstick' 'Poultry Thigh' 'Poultry Tender' 'Poultry Wing'
 'Poultry Other' 'Misc' 'Chicken Wings' 'Chicken Leg Meat']
2025-06-06 20:53:18,371 - __main__ - INFO - Category counts: {'Beef Rib': 87, 'Pork Loin': 85, 'Pork Other': 81, 'Beef Flank': 80, 'Beef Chuck': 68, 'Chicken Main': 68, 'Uncategorized': 49, 'Delete Items': 48, 'Pork Rib': 48, 'Poultry Breast': 46, 'Misc': 28, 'Duck': 24, 'Pork Ham/Leg': 23, 'Misc. Items': 18, 'Dim Sum': 18, 'Miscellaneous Beef': 15, 'Goat': 15, 'Ground Beef Anmar Production': 12, 'Pork Shoulder': 12, 'Poultry Ground': 12, 'DISCONTINUED ITEMS': 12, 'Beef,Pork-Sausage,Smok': 12, 'Pork Variety': 11, 'Beef Variety & Misc': 10, 'Beef Ground': 10, 'Plate': 9, 'Poultry Thigh': 9, 'Chicken Leg Meat': 9, 'Beef Loin': 8, 'Lamb': 7, 'Ground Beef': 7, 'Turkey': 6, 'Chicken Variety': 6, 'Wild Game': 6, 'Beef Round': 6, 'Brisket': 6, 'Poultry Whole': 5, 'Poultry Tender': 4, 'Poultry Other': 4, 'Poultry Wing': 4, 'Pork Butt': 4, 'Poultry Leg': 4, 'Poultry Drumstick': 4, 'Pork Belly': 4, 'Veal': 3, 'Chicken Misc.': 3, 'Pork Hams': 3, 'Chicken Wings': 3, 'Rib': 3, 'Veal Strauss': 3, 'Game Meat': 3, 'Chicken Airline Breast': 3, 'Halal': 3, 'Rabbit': 3, 'Pork Sausage': 3, 'Pot Sticker': 3, 'Non Product': 3, 'Supplies': 3, 'Beef Other': 1, 'Sausage': 1, 'Hot Dogs': 1}
2025-06-06 20:53:18,371 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 20:53:18,372 - __main__ - INFO - Found 68 records for Beef Chuck
2025-06-06 20:53:18,372 - __main__ - INFO - Test run: Processing only 10 records
2025-06-06 20:53:18,372 - llm_extraction.batch_processor - INFO - Processing 10 records for Beef Chuck
2025-06-06 20:53:18,506 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-46c7fb30-654f-44c3-892c-27198ee8c140', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:53:18,528 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:53:18,982 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-e5f1a117-5361-4965-8076-d6dde5ac9ff5', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:53:18,982 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-a5edd28b-1b18-42a2-88df-2f899b64d6f5', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:53:18,983 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-a8e1aaf5-3702-4fc5-9a52-68a6601a355e', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:53:18,983 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-94aba621-6b5a-4a2f-b97c-35b970e6a459', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "None"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 20:53:18,983 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:53:18,984 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:53:18,984 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:53:18,984 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 20:57:42,613 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 20:57:42,614 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 20:57:42,614 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 20:57:42,614 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 20:57:42,614 - __main__ - ERROR - Error processing product query file: name 'pd' is not defined
2025-06-06 20:57:42,614 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 20:57:42,615 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 20:57:42,615 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 20:57:42,615 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 20:57:42,615 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 20:57:42,616 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 20:57:42,841 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:57:42,841 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:57:42,842 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 20:57:42,842 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 20:57:42,854 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 20:57:42,854 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 20:57:42,859 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:57:42,859 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:57:42,861 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 20:57:42,861 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 20:57:42,863 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 20:57:42,866 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 20:57:42,885 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:57:42,889 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:57:42,895 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 20:57:42,895 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 20:57:42,907 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 20:57:42,909 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 20:57:42,931 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description']
2025-06-06 20:57:42,932 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 20:57:42,937 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 20:57:42,976 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 20:57:42,976 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 20:57:42,977 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 20:57:43,241 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:57:43,241 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 20:57:43,241 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 20:57:43,241 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 20:57:43,289 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 20:57:43,289 - __main__ - INFO - Available categories in data: ['Uncategorized' 'Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground'
 'Miscellaneous Beef' 'Pork Rib' 'Pork Other' 'Rib' 'Beef Flank'
 'Pork Loin' 'Misc. Items' 'Beef Chuck' 'Chicken Misc.'
 'Chicken Airline Breast' 'Ground Beef Anmar Production'
 'Beef Variety & Misc' 'Beef Other' 'Delete Items' 'Beef Rib'
 'Beef Ground' 'Lamb' 'Hot Dogs' 'Beef Round' 'Pork Sausage' 'Beef Loin'
 'Goat' 'Wild Game' 'Veal' 'Halal' 'Supplies' 'Pot Sticker' 'Dim Sum'
 'Beef,Pork-Sausage,Smok' 'Pork Ham/Leg' 'Rabbit' 'DISCONTINUED ITEMS'
 'Pork Butt' 'Chicken Main' 'Pork Variety' 'Ground Beef' 'Poultry Leg'
 'Pork Shoulder' 'Pork Belly' 'Veal Strauss' 'Brisket' 'Chicken Variety'
 'Plate' 'Game Meat' 'Duck' 'Poultry Breast' 'Poultry Whole' 'Turkey'
 'Poultry Drumstick' 'Poultry Thigh' 'Poultry Tender' 'Poultry Wing'
 'Poultry Other' 'Misc' 'Chicken Wings' 'Chicken Leg Meat']
2025-06-06 20:57:43,290 - __main__ - INFO - Category counts: {'Beef Rib': 87, 'Pork Loin': 85, 'Pork Other': 81, 'Beef Flank': 80, 'Beef Chuck': 68, 'Chicken Main': 68, 'Uncategorized': 49, 'Delete Items': 48, 'Pork Rib': 48, 'Poultry Breast': 46, 'Misc': 28, 'Duck': 24, 'Pork Ham/Leg': 23, 'Misc. Items': 18, 'Dim Sum': 18, 'Miscellaneous Beef': 15, 'Goat': 15, 'Ground Beef Anmar Production': 12, 'Pork Shoulder': 12, 'Poultry Ground': 12, 'DISCONTINUED ITEMS': 12, 'Beef,Pork-Sausage,Smok': 12, 'Pork Variety': 11, 'Beef Variety & Misc': 10, 'Beef Ground': 10, 'Plate': 9, 'Poultry Thigh': 9, 'Chicken Leg Meat': 9, 'Beef Loin': 8, 'Lamb': 7, 'Ground Beef': 7, 'Turkey': 6, 'Chicken Variety': 6, 'Wild Game': 6, 'Beef Round': 6, 'Brisket': 6, 'Poultry Whole': 5, 'Poultry Tender': 4, 'Poultry Other': 4, 'Poultry Wing': 4, 'Pork Butt': 4, 'Poultry Leg': 4, 'Poultry Drumstick': 4, 'Pork Belly': 4, 'Veal': 3, 'Chicken Misc.': 3, 'Pork Hams': 3, 'Chicken Wings': 3, 'Rib': 3, 'Veal Strauss': 3, 'Game Meat': 3, 'Chicken Airline Breast': 3, 'Halal': 3, 'Rabbit': 3, 'Pork Sausage': 3, 'Pot Sticker': 3, 'Non Product': 3, 'Supplies': 3, 'Beef Other': 1, 'Sausage': 1, 'Hot Dogs': 1}
2025-06-06 20:57:43,290 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 20:57:43,291 - __main__ - INFO - Found 68 records for Beef Chuck
2025-06-06 20:57:43,291 - __main__ - INFO - Test run: Processing only 10 records
2025-06-06 20:57:43,291 - llm_extraction.batch_processor - INFO - Processing 10 records for Beef Chuck
2025-06-06 20:57:43,294 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 20:57:43,294 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 20:57:43,294 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 20:57:43,294 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 20:57:43,295 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 20:57:43,295 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 20:57:43,295 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 20:57:43,295 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 20:57:43,295 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 20:57:43,295 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 20:57:43,301 - llm_extraction.batch_processor - INFO - Batch processing complete. 10 records processed.
2025-06-06 20:57:43,301 - __main__ - INFO - Successfully processed 10 records for Beef Chuck
2025-06-06 20:57:43,301 - __main__ - INFO - 📤 Stage 3: Output Generation
2025-06-06 20:57:43,304 - output_generation.file_writer - INFO - Separated data: 0 clean records, 10 flagged records
2025-06-06 20:57:43,307 - output_generation.file_writer - INFO - Written 10 flagged records to outputs/beef_chuck_extracted_flagged.csv
2025-06-06 20:57:43,308 - __main__ - INFO - Output files created: ['Beef Chuck']
2025-06-06 20:57:43,308 - __main__ - INFO - ⏭️ Stage 4: Database Upload (Skipped - use --upload-to-firebase to enable)
2025-06-06 20:57:43,308 - __main__ - INFO - ✅ Pipeline Complete!
2025-06-06 20:57:43,308 - __main__ - INFO - 📊 Summary:
2025-06-06 20:57:43,308 - __main__ - INFO -    Total records processed: 10
2025-06-06 20:57:43,308 - __main__ - INFO -    Records needing review: 10 (100.0%)
2025-06-06 20:57:43,308 - __main__ - INFO -    Average confidence: 0.00
2025-06-06 20:57:43,308 - __main__ - WARNING - Some records need review - check flagged output files
2025-06-06 21:02:17,871 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 21:02:17,871 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 21:02:17,871 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 21:02:17,872 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 21:02:17,872 - __main__ - ERROR - Error processing product query file: name 'pd' is not defined
2025-06-06 21:02:17,872 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 21:02:17,874 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 21:02:17,874 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 21:02:17,875 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 21:02:17,876 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 21:02:17,876 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 21:02:18,081 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 21:02:18,081 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 21:02:18,081 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 21:02:18,081 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 21:02:18,087 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 21:02:18,087 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 21:02:18,091 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 21:02:18,091 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 21:02:18,091 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 21:02:18,097 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 21:02:18,098 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 21:02:18,104 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 21:02:18,104 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 21:02:18,110 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 21:02:18,111 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 21:02:18,113 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 21:02:18,117 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 21:02:18,118 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 21:02:18,133 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description']
2025-06-06 21:02:18,134 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 21:02:18,137 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 21:02:18,160 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 21:02:18,160 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 21:02:18,161 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 21:02:18,291 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:02:18,291 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:02:18,291 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 21:02:18,291 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 21:02:18,328 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 21:02:18,328 - __main__ - INFO - Available categories in data: ['Uncategorized' 'Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground'
 'Miscellaneous Beef' 'Pork Rib' 'Pork Other' 'Rib' 'Beef Flank'
 'Pork Loin' 'Misc. Items' 'Beef Chuck' 'Chicken Misc.'
 'Chicken Airline Breast' 'Ground Beef Anmar Production'
 'Beef Variety & Misc' 'Beef Other' 'Delete Items' 'Beef Rib'
 'Beef Ground' 'Lamb' 'Hot Dogs' 'Beef Round' 'Pork Sausage' 'Beef Loin'
 'Goat' 'Wild Game' 'Veal' 'Halal' 'Supplies' 'Pot Sticker' 'Dim Sum'
 'Beef,Pork-Sausage,Smok' 'Pork Ham/Leg' 'Rabbit' 'DISCONTINUED ITEMS'
 'Pork Butt' 'Chicken Main' 'Pork Variety' 'Ground Beef' 'Poultry Leg'
 'Pork Shoulder' 'Pork Belly' 'Veal Strauss' 'Brisket' 'Chicken Variety'
 'Plate' 'Game Meat' 'Duck' 'Poultry Breast' 'Poultry Whole' 'Turkey'
 'Poultry Drumstick' 'Poultry Thigh' 'Poultry Tender' 'Poultry Wing'
 'Poultry Other' 'Misc' 'Chicken Wings' 'Chicken Leg Meat']
2025-06-06 21:02:18,329 - __main__ - INFO - Category counts: {'Beef Rib': 87, 'Pork Loin': 85, 'Pork Other': 81, 'Beef Flank': 80, 'Beef Chuck': 68, 'Chicken Main': 68, 'Uncategorized': 49, 'Delete Items': 48, 'Pork Rib': 48, 'Poultry Breast': 46, 'Misc': 28, 'Duck': 24, 'Pork Ham/Leg': 23, 'Misc. Items': 18, 'Dim Sum': 18, 'Miscellaneous Beef': 15, 'Goat': 15, 'Ground Beef Anmar Production': 12, 'Pork Shoulder': 12, 'Poultry Ground': 12, 'DISCONTINUED ITEMS': 12, 'Beef,Pork-Sausage,Smok': 12, 'Pork Variety': 11, 'Beef Variety & Misc': 10, 'Beef Ground': 10, 'Plate': 9, 'Poultry Thigh': 9, 'Chicken Leg Meat': 9, 'Beef Loin': 8, 'Lamb': 7, 'Ground Beef': 7, 'Turkey': 6, 'Chicken Variety': 6, 'Wild Game': 6, 'Beef Round': 6, 'Brisket': 6, 'Poultry Whole': 5, 'Poultry Tender': 4, 'Poultry Other': 4, 'Poultry Wing': 4, 'Pork Butt': 4, 'Poultry Leg': 4, 'Poultry Drumstick': 4, 'Pork Belly': 4, 'Veal': 3, 'Chicken Misc.': 3, 'Pork Hams': 3, 'Chicken Wings': 3, 'Rib': 3, 'Veal Strauss': 3, 'Game Meat': 3, 'Chicken Airline Breast': 3, 'Halal': 3, 'Rabbit': 3, 'Pork Sausage': 3, 'Pot Sticker': 3, 'Non Product': 3, 'Supplies': 3, 'Beef Other': 1, 'Sausage': 1, 'Hot Dogs': 1}
2025-06-06 21:02:18,329 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 21:02:18,330 - __main__ - INFO - Found 68 records for Beef Chuck
2025-06-06 21:02:18,330 - __main__ - INFO - Test run: Processing only 10 records
2025-06-06 21:02:18,330 - llm_extraction.batch_processor - INFO - Processing 10 records for Beef Chuck
2025-06-06 21:02:18,332 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:18,332 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:18,332 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:18,332 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:18,332 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:18,333 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:18,333 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:18,333 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:18,333 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:18,333 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:18,337 - llm_extraction.batch_processor - INFO - Batch processing complete. 10 records processed.
2025-06-06 21:02:18,337 - __main__ - INFO - Successfully processed 10 records for Beef Chuck
2025-06-06 21:02:18,337 - __main__ - INFO - 📤 Stage 3: Output Generation
2025-06-06 21:02:18,339 - output_generation.file_writer - INFO - Separated data: 0 clean records, 10 flagged records
2025-06-06 21:02:18,340 - output_generation.file_writer - INFO - Written 10 flagged records to outputs/beef_chuck_extracted_flagged.csv
2025-06-06 21:02:18,340 - __main__ - INFO - Output files created: ['Beef Chuck']
2025-06-06 21:02:18,340 - __main__ - INFO - ⏭️ Stage 4: Database Upload (Skipped - use --upload-to-firebase to enable)
2025-06-06 21:02:18,340 - __main__ - INFO - ✅ Pipeline Complete!
2025-06-06 21:02:18,340 - __main__ - INFO - 📊 Summary:
2025-06-06 21:02:18,340 - __main__ - INFO -    Total records processed: 10
2025-06-06 21:02:18,340 - __main__ - INFO -    Records needing review: 10 (100.0%)
2025-06-06 21:02:18,340 - __main__ - INFO -    Average confidence: 0.00
2025-06-06 21:02:18,341 - __main__ - WARNING - Some records need review - check flagged output files
2025-06-06 21:02:48,296 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 21:02:48,296 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 21:02:48,296 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 21:02:48,296 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 21:02:48,296 - __main__ - ERROR - Error processing product query file: name 'pd' is not defined
2025-06-06 21:02:48,296 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 21:02:48,297 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 21:02:48,297 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 21:02:48,297 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 21:02:48,297 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 21:02:48,298 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 21:02:48,426 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 21:02:48,426 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 21:02:48,426 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 21:02:48,426 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 21:02:48,428 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 21:02:48,430 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 21:02:48,433 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 21:02:48,433 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 21:02:48,434 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 21:02:48,434 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 21:02:48,435 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 21:02:48,437 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 21:02:48,447 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 21:02:48,448 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 21:02:48,450 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 21:02:48,453 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 21:02:48,458 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 21:02:48,460 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 21:02:48,471 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description']
2025-06-06 21:02:48,472 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 21:02:48,476 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 21:02:48,499 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 21:02:48,499 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 21:02:48,499 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 21:02:48,623 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:02:48,623 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:02:48,623 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 21:02:48,623 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 21:02:48,653 - __main__ - INFO - Loaded 1049 records from processed data
2025-06-06 21:02:48,654 - __main__ - INFO - Available categories in data: ['Uncategorized' 'Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground'
 'Miscellaneous Beef' 'Pork Rib' 'Pork Other' 'Rib' 'Beef Flank'
 'Pork Loin' 'Misc. Items' 'Beef Chuck' 'Chicken Misc.'
 'Chicken Airline Breast' 'Ground Beef Anmar Production'
 'Beef Variety & Misc' 'Beef Other' 'Delete Items' 'Beef Rib'
 'Beef Ground' 'Lamb' 'Hot Dogs' 'Beef Round' 'Pork Sausage' 'Beef Loin'
 'Goat' 'Wild Game' 'Veal' 'Halal' 'Supplies' 'Pot Sticker' 'Dim Sum'
 'Beef,Pork-Sausage,Smok' 'Pork Ham/Leg' 'Rabbit' 'DISCONTINUED ITEMS'
 'Pork Butt' 'Chicken Main' 'Pork Variety' 'Ground Beef' 'Poultry Leg'
 'Pork Shoulder' 'Pork Belly' 'Veal Strauss' 'Brisket' 'Chicken Variety'
 'Plate' 'Game Meat' 'Duck' 'Poultry Breast' 'Poultry Whole' 'Turkey'
 'Poultry Drumstick' 'Poultry Thigh' 'Poultry Tender' 'Poultry Wing'
 'Poultry Other' 'Misc' 'Chicken Wings' 'Chicken Leg Meat']
2025-06-06 21:02:48,654 - __main__ - INFO - Category counts: {'Beef Rib': 87, 'Pork Loin': 85, 'Pork Other': 81, 'Beef Flank': 80, 'Beef Chuck': 68, 'Chicken Main': 68, 'Uncategorized': 49, 'Delete Items': 48, 'Pork Rib': 48, 'Poultry Breast': 46, 'Misc': 28, 'Duck': 24, 'Pork Ham/Leg': 23, 'Misc. Items': 18, 'Dim Sum': 18, 'Miscellaneous Beef': 15, 'Goat': 15, 'Ground Beef Anmar Production': 12, 'Pork Shoulder': 12, 'Poultry Ground': 12, 'DISCONTINUED ITEMS': 12, 'Beef,Pork-Sausage,Smok': 12, 'Pork Variety': 11, 'Beef Variety & Misc': 10, 'Beef Ground': 10, 'Plate': 9, 'Poultry Thigh': 9, 'Chicken Leg Meat': 9, 'Beef Loin': 8, 'Lamb': 7, 'Ground Beef': 7, 'Turkey': 6, 'Chicken Variety': 6, 'Wild Game': 6, 'Beef Round': 6, 'Brisket': 6, 'Poultry Whole': 5, 'Poultry Tender': 4, 'Poultry Other': 4, 'Poultry Wing': 4, 'Pork Butt': 4, 'Poultry Leg': 4, 'Poultry Drumstick': 4, 'Pork Belly': 4, 'Veal': 3, 'Chicken Misc.': 3, 'Pork Hams': 3, 'Chicken Wings': 3, 'Rib': 3, 'Veal Strauss': 3, 'Game Meat': 3, 'Chicken Airline Breast': 3, 'Halal': 3, 'Rabbit': 3, 'Pork Sausage': 3, 'Pot Sticker': 3, 'Non Product': 3, 'Supplies': 3, 'Beef Other': 1, 'Sausage': 1, 'Hot Dogs': 1}
2025-06-06 21:02:48,654 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 21:02:48,655 - __main__ - INFO - Found 68 records for Beef Chuck
2025-06-06 21:02:48,655 - __main__ - INFO - Test run: Processing only 10 records
2025-06-06 21:02:48,655 - llm_extraction.batch_processor - INFO - Processing 10 records for Beef Chuck
2025-06-06 21:02:48,657 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:48,657 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:48,657 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:48,657 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:48,659 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:48,660 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:48,660 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:48,660 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:48,660 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:48,660 - llm_extraction.batch_processor - WARNING - Skipping extraction for record with null/empty description
2025-06-06 21:02:48,664 - llm_extraction.batch_processor - INFO - Batch processing complete. 10 records processed.
2025-06-06 21:02:48,664 - __main__ - INFO - Successfully processed 10 records for Beef Chuck
2025-06-06 21:02:48,664 - __main__ - INFO - 📤 Stage 3: Output Generation
2025-06-06 21:02:48,665 - output_generation.file_writer - INFO - Separated data: 0 clean records, 10 flagged records
2025-06-06 21:02:48,667 - output_generation.file_writer - INFO - Written 10 flagged records to outputs/beef_chuck_extracted_flagged.csv
2025-06-06 21:02:48,667 - __main__ - INFO - Output files created: ['Beef Chuck']
2025-06-06 21:02:48,667 - __main__ - INFO - ⏭️ Stage 4: Database Upload (Skipped - use --upload-to-firebase to enable)
2025-06-06 21:02:48,667 - __main__ - INFO - ✅ Pipeline Complete!
2025-06-06 21:02:48,667 - __main__ - INFO - 📊 Summary:
2025-06-06 21:02:48,667 - __main__ - INFO -    Total records processed: 10
2025-06-06 21:02:48,667 - __main__ - INFO -    Records needing review: 10 (100.0%)
2025-06-06 21:02:48,667 - __main__ - INFO -    Average confidence: 0.00
2025-06-06 21:02:48,667 - __main__ - WARNING - Some records need review - check flagged output files
2025-06-06 21:06:39,939 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 21:06:39,939 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 21:06:39,939 - __main__ - INFO - 📥 Stage 1: Data Ingestion
2025-06-06 21:06:39,939 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 21:06:39,945 - __main__ - INFO - Read 1000 records from Product_Query_2025_06_06.csv with columns: ['ProductSK', 'SourceProductKey', 'ProductCode', 'ProductWarehouseCode', 'ProductDescription', 'ProductDescription2', 'ProductCategoryCode', 'ProductCategory', 'ProductMainCategoryCode', 'ProductMainCategory', 'WarehouseCode', 'Warehouse', 'WarehouseShort', 'ProcessCode', 'ProcessCodeDescription', 'AlphaName', 'BrandCode', 'BrandDescription', 'BrandRate', 'UnitOfMeasure_Stk', 'UnitOfMeasure_Alt', 'WeightConversion', 'UnitOfMeasure_Case', 'SourceSystems', 'LatestProductKeyVersion', 'IsCurrentRecordFlag']
2025-06-06 21:06:39,945 - __main__ - INFO - Test run: Processing only 10 products
2025-06-06 21:06:39,945 - data_ingestion.core.product_transformer - INFO - Processing product data: 10 records with columns ['ProductSK', 'SourceProductKey', 'ProductCode', 'ProductWarehouseCode', 'ProductDescription', 'ProductDescription2', 'ProductCategoryCode', 'ProductCategory', 'ProductMainCategoryCode', 'ProductMainCategory', 'WarehouseCode', 'Warehouse', 'WarehouseShort', 'ProcessCode', 'ProcessCodeDescription', 'AlphaName', 'BrandCode', 'BrandDescription', 'BrandRate', 'UnitOfMeasure_Stk', 'UnitOfMeasure_Alt', 'WeightConversion', 'UnitOfMeasure_Case', 'SourceSystems', 'LatestProductKeyVersion', 'IsCurrentRecordFlag']
2025-06-06 21:06:39,945 - data_ingestion.core.product_transformer - INFO - Primary description column 'ProductDescription' stats: 10 total rows, 0 null values, 0 empty strings
2025-06-06 21:06:39,946 - data_ingestion.core.product_transformer - INFO - Secondary description column 'ProductDescription2' stats: 10 total rows, 7 null values, 0 empty strings
2025-06-06 21:06:39,947 - data_ingestion.core.product_transformer - INFO - Merged description column 'product_description' stats: 10 total rows, 0 null values, 0 empty strings
2025-06-06 21:06:39,948 - data_ingestion.core.product_transformer - INFO - Mapped ProductCategory to category_description with 4 unique categories
2025-06-06 21:06:39,948 - data_ingestion.core.product_transformer - INFO - Mapped BrandName to brand_name
2025-06-06 21:06:39,948 - data_ingestion.core.product_transformer - INFO - Mapped ProductCode to product_code
2025-06-06 21:06:39,948 - data_ingestion.core.product_transformer - INFO - Mapped ProductDescription to product_description
2025-06-06 21:06:39,948 - data_ingestion.core.product_transformer - INFO - Final validation successful. Processed 10 records with required columns present.
2025-06-06 21:06:39,949 - data_ingestion.core.product_transformer - INFO - Product description column stats: count                         10
unique                         4
top       MATRIX PRICING PRODUCT
freq                           3
Name: product_description, dtype: object
2025-06-06 21:06:39,949 - data_ingestion.core.product_transformer - INFO - Processed 10 product records with transformations
2025-06-06 21:06:39,970 - __main__ - INFO - Saved processed product data with 10 records to data/processed/product_query_processed.parquet
2025-06-06 21:06:39,972 - __main__ - INFO - Also saved as CSV to data/processed/product_query_processed.csv
2025-06-06 21:06:39,972 - __main__ - INFO - Successfully processed product query data
2025-06-06 21:06:39,972 - data_ingestion.core.processor - INFO - Starting data ingestion pipeline
2025-06-06 21:06:39,973 - data_ingestion.core.processor - INFO - Found 8 files to process
2025-06-06 21:06:39,973 - data_ingestion.core.reader - INFO - Reading file: Corrected_mapping.xlsx
2025-06-06 21:06:39,973 - data_ingestion.core.reader - INFO - Reading file: beef_cuts.xlsx
2025-06-06 21:06:39,973 - data_ingestion.core.reader - INFO - Reading file: Fulton Inventory Valuation.xls
2025-06-06 21:06:39,973 - data_ingestion.core.reader - INFO - Reading file: Pritzlaff Inventory Report.xls
2025-06-06 21:06:40,118 - data_ingestion.core.reader - ERROR - Error reading Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 21:06:40,119 - data_ingestion.core.reader - ERROR - Error reading Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 21:06:40,119 - data_ingestion.core.processor - ERROR - Error processing Pritzlaff Inventory Report.xls: File is not a zip file
2025-06-06 21:06:40,119 - data_ingestion.core.processor - ERROR - Error processing Fulton Inventory Valuation.xls: File is not a zip file
2025-06-06 21:06:40,120 - data_ingestion.core.reader - INFO - Reading file: Queen Inventory Valuation.xls
2025-06-06 21:06:40,120 - data_ingestion.core.reader - INFO - Reading file: Moesle Inventory Valuation - email.xls
2025-06-06 21:06:40,127 - data_ingestion.core.reader - ERROR - Error reading Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 21:06:40,127 - data_ingestion.core.processor - ERROR - Error processing Queen Inventory Valuation.xls: File is not a zip file
2025-06-06 21:06:40,128 - data_ingestion.core.reader - INFO - Reading file: Anmar Inventory Valuation.xls
2025-06-06 21:06:40,128 - data_ingestion.core.reader - ERROR - Error reading Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 21:06:40,128 - data_ingestion.core.processor - ERROR - Error processing Moesle Inventory Valuation - email.xls: File is not a zip file
2025-06-06 21:06:40,128 - data_ingestion.core.reader - INFO - Reading file: Product_Query_2025_06_06.csv
2025-06-06 21:06:40,131 - data_ingestion.core.reader - ERROR - Error reading Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 21:06:40,131 - data_ingestion.core.processor - ERROR - Error processing Anmar Inventory Valuation.xls: File is not a zip file
2025-06-06 21:06:40,140 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 21:06:40,150 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description', 'category_description']
2025-06-06 21:06:40,153 - data_ingestion.core.processor - INFO - Successfully processed beef_cuts.xlsx with 12 rows
2025-06-06 21:06:40,158 - data_ingestion.core.processor - INFO - Successfully processed Corrected_mapping.xlsx with 37 rows
2025-06-06 21:06:40,166 - data_ingestion.core.cleaner - WARNING - Missing required columns: ['product_code', 'product_description']
2025-06-06 21:06:40,167 - data_ingestion.core.processor - INFO - Successfully processed Product_Query_2025_06_06.csv with 1000 rows
2025-06-06 21:06:40,170 - data_ingestion.core.processor - INFO - Combined data: 1049 rows
2025-06-06 21:06:40,177 - data_ingestion.core.processor - INFO - Saved 1049 rows to data/processed/inventory_base.parquet
2025-06-06 21:06:40,177 - data_ingestion.core.processor - INFO - Data ingestion pipeline completed successfully
2025-06-06 21:06:40,177 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 21:06:40,308 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:06:40,308 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:06:40,308 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 21:06:40,308 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 21:06:40,339 - __main__ - INFO - Loaded 10 records from processed product query data
2025-06-06 21:06:40,339 - __main__ - INFO - Available categories in data: ['Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground']
2025-06-06 21:06:40,339 - __main__ - INFO - Category counts: {'Non Product': 3, 'Pork Hams': 3, 'Poultry Ground': 3, 'Sausage': 1}
2025-06-06 21:06:40,339 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 21:06:40,340 - __main__ - INFO - Found 0 records for Beef Chuck
2025-06-06 21:06:40,340 - __main__ - WARNING - No records found for exact 'Beef Chuck' match, trying word boundaries
2025-06-06 21:06:40,340 - __main__ - INFO - Found 0 records with word boundary matching
2025-06-06 21:06:40,340 - __main__ - WARNING - Still no records found for Beef Chuck
2025-06-06 21:06:40,341 - __main__ - INFO - Sample categories:
['Non Product', 'Non Product', 'Non Product', 'Pork Hams', 'Pork Hams', 'Pork Hams', 'Sausage', 'Poultry Ground', 'Poultry Ground', 'Poultry Ground']
2025-06-06 21:06:40,341 - __main__ - ERROR - No results to process. Exiting.
2025-06-06 21:12:43,542 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 21:12:43,542 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 21:12:43,542 - __main__ - INFO - 📥 Stage 1: Data Ingestion - Product Query Processing
2025-06-06 21:12:43,544 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 21:12:43,550 - __main__ - INFO - Read 1000 records from Product_Query_2025_06_06.csv with columns: ['ProductSK', 'SourceProductKey', 'ProductCode', 'ProductWarehouseCode', 'ProductDescription', 'ProductDescription2', 'ProductCategoryCode', 'ProductCategory', 'ProductMainCategoryCode', 'ProductMainCategory', 'WarehouseCode', 'Warehouse', 'WarehouseShort', 'ProcessCode', 'ProcessCodeDescription', 'AlphaName', 'BrandCode', 'BrandDescription', 'BrandRate', 'UnitOfMeasure_Stk', 'UnitOfMeasure_Alt', 'WeightConversion', 'UnitOfMeasure_Case', 'SourceSystems', 'LatestProductKeyVersion', 'IsCurrentRecordFlag']
2025-06-06 21:12:43,550 - __main__ - INFO - Test run: Processing only 10 products
2025-06-06 21:12:43,550 - data_ingestion.core.product_transformer - INFO - Processing product data: 10 records with columns ['ProductSK', 'SourceProductKey', 'ProductCode', 'ProductWarehouseCode', 'ProductDescription', 'ProductDescription2', 'ProductCategoryCode', 'ProductCategory', 'ProductMainCategoryCode', 'ProductMainCategory', 'WarehouseCode', 'Warehouse', 'WarehouseShort', 'ProcessCode', 'ProcessCodeDescription', 'AlphaName', 'BrandCode', 'BrandDescription', 'BrandRate', 'UnitOfMeasure_Stk', 'UnitOfMeasure_Alt', 'WeightConversion', 'UnitOfMeasure_Case', 'SourceSystems', 'LatestProductKeyVersion', 'IsCurrentRecordFlag']
2025-06-06 21:12:43,550 - data_ingestion.core.product_transformer - INFO - Primary description column 'ProductDescription' stats: 10 total rows, 0 null values, 0 empty strings
2025-06-06 21:12:43,551 - data_ingestion.core.product_transformer - INFO - Secondary description column 'ProductDescription2' stats: 10 total rows, 7 null values, 0 empty strings
2025-06-06 21:12:43,552 - data_ingestion.core.product_transformer - INFO - Merged description column 'product_description' stats: 10 total rows, 0 null values, 0 empty strings
2025-06-06 21:12:43,552 - data_ingestion.core.product_transformer - INFO - Mapped ProductCategory to category_description with 4 unique categories
2025-06-06 21:12:43,552 - data_ingestion.core.product_transformer - INFO - Mapped BrandName to brand_name
2025-06-06 21:12:43,552 - data_ingestion.core.product_transformer - INFO - Mapped ProductCode to product_code
2025-06-06 21:12:43,552 - data_ingestion.core.product_transformer - INFO - Mapped ProductDescription to product_description
2025-06-06 21:12:43,553 - data_ingestion.core.product_transformer - INFO - Final validation successful. Processed 10 records with required columns present.
2025-06-06 21:12:43,553 - data_ingestion.core.product_transformer - INFO - Product description column stats: count                         10
unique                         4
top       MATRIX PRICING PRODUCT
freq                           3
Name: product_description, dtype: object
2025-06-06 21:12:43,553 - data_ingestion.core.product_transformer - INFO - Processed 10 product records with transformations
2025-06-06 21:12:43,578 - __main__ - INFO - Saved processed product data with 10 records to data/processed/product_query_processed.parquet
2025-06-06 21:12:43,581 - __main__ - INFO - Also saved as CSV to data/processed/product_query_processed.csv
2025-06-06 21:12:43,581 - __main__ - INFO - ✅ Successfully processed product query data
2025-06-06 21:12:43,581 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 21:12:44,009 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:12:44,010 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:12:44,010 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 21:12:44,010 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 21:12:44,038 - __main__ - INFO - Loaded 10 records from processed product query data
2025-06-06 21:12:44,038 - __main__ - INFO - Available categories in data: ['Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground']
2025-06-06 21:12:44,039 - __main__ - INFO - Category counts: {'Non Product': 3, 'Pork Hams': 3, 'Poultry Ground': 3, 'Sausage': 1}
2025-06-06 21:12:44,039 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 21:12:44,039 - __main__ - INFO - Found 0 records for Beef Chuck
2025-06-06 21:12:44,039 - __main__ - WARNING - No records found for exact 'Beef Chuck' match, trying word boundaries
2025-06-06 21:12:44,039 - __main__ - INFO - Found 0 records with word boundary matching
2025-06-06 21:12:44,039 - __main__ - WARNING - Still no records found for Beef Chuck
2025-06-06 21:12:44,039 - __main__ - INFO - Sample categories:
['Non Product', 'Non Product', 'Non Product', 'Pork Hams', 'Pork Hams', 'Pork Hams', 'Sausage', 'Poultry Ground', 'Poultry Ground', 'Poultry Ground']
2025-06-06 21:12:44,039 - __main__ - ERROR - No results to process. Exiting.
2025-06-06 21:13:08,875 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 21:13:08,875 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 21:13:08,875 - __main__ - INFO - 📥 Stage 1: Data Ingestion - Product Query Processing
2025-06-06 21:13:08,878 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 21:13:08,883 - __main__ - INFO - Read 1000 records from Product_Query_2025_06_06.csv with columns: ['ProductSK', 'SourceProductKey', 'ProductCode', 'ProductWarehouseCode', 'ProductDescription', 'ProductDescription2', 'ProductCategoryCode', 'ProductCategory', 'ProductMainCategoryCode', 'ProductMainCategory', 'WarehouseCode', 'Warehouse', 'WarehouseShort', 'ProcessCode', 'ProcessCodeDescription', 'AlphaName', 'BrandCode', 'BrandDescription', 'BrandRate', 'UnitOfMeasure_Stk', 'UnitOfMeasure_Alt', 'WeightConversion', 'UnitOfMeasure_Case', 'SourceSystems', 'LatestProductKeyVersion', 'IsCurrentRecordFlag']
2025-06-06 21:13:08,883 - __main__ - INFO - Test run: Processing only 10 products
2025-06-06 21:13:08,883 - data_ingestion.core.product_transformer - INFO - Processing product data: 10 records with columns ['ProductSK', 'SourceProductKey', 'ProductCode', 'ProductWarehouseCode', 'ProductDescription', 'ProductDescription2', 'ProductCategoryCode', 'ProductCategory', 'ProductMainCategoryCode', 'ProductMainCategory', 'WarehouseCode', 'Warehouse', 'WarehouseShort', 'ProcessCode', 'ProcessCodeDescription', 'AlphaName', 'BrandCode', 'BrandDescription', 'BrandRate', 'UnitOfMeasure_Stk', 'UnitOfMeasure_Alt', 'WeightConversion', 'UnitOfMeasure_Case', 'SourceSystems', 'LatestProductKeyVersion', 'IsCurrentRecordFlag']
2025-06-06 21:13:08,884 - data_ingestion.core.product_transformer - INFO - Primary description column 'ProductDescription' stats: 10 total rows, 0 null values, 0 empty strings
2025-06-06 21:13:08,884 - data_ingestion.core.product_transformer - INFO - Secondary description column 'ProductDescription2' stats: 10 total rows, 7 null values, 0 empty strings
2025-06-06 21:13:08,885 - data_ingestion.core.product_transformer - INFO - Merged description column 'product_description' stats: 10 total rows, 0 null values, 0 empty strings
2025-06-06 21:13:08,886 - data_ingestion.core.product_transformer - INFO - Mapped ProductCategory to category_description with 4 unique categories
2025-06-06 21:13:08,886 - data_ingestion.core.product_transformer - INFO - Mapped BrandName to brand_name
2025-06-06 21:13:08,886 - data_ingestion.core.product_transformer - INFO - Mapped ProductCode to product_code
2025-06-06 21:13:08,886 - data_ingestion.core.product_transformer - INFO - Mapped ProductDescription to product_description
2025-06-06 21:13:08,886 - data_ingestion.core.product_transformer - INFO - Final validation successful. Processed 10 records with required columns present.
2025-06-06 21:13:08,887 - data_ingestion.core.product_transformer - INFO - Product description column stats: count                         10
unique                         4
top       MATRIX PRICING PRODUCT
freq                           3
Name: product_description, dtype: object
2025-06-06 21:13:08,887 - data_ingestion.core.product_transformer - INFO - Processed 10 product records with transformations
2025-06-06 21:13:08,905 - __main__ - INFO - Saved processed product data with 10 records to data/processed/product_query_processed.parquet
2025-06-06 21:13:08,906 - __main__ - INFO - Also saved as CSV to data/processed/product_query_processed.csv
2025-06-06 21:13:08,907 - __main__ - INFO - ✅ Successfully processed product query data
2025-06-06 21:13:08,907 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 21:13:09,158 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:13:09,158 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:13:09,158 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 21:13:09,158 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 21:13:09,184 - __main__ - INFO - Loaded 10 records from processed product query data
2025-06-06 21:13:09,184 - __main__ - INFO - Available categories in data: ['Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground']
2025-06-06 21:13:09,185 - __main__ - INFO - Category counts: {'Non Product': 3, 'Pork Hams': 3, 'Poultry Ground': 3, 'Sausage': 1}
2025-06-06 21:13:09,185 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 21:13:09,185 - __main__ - INFO - Found 0 records for Beef Chuck
2025-06-06 21:13:09,185 - __main__ - WARNING - No records found for exact 'Beef Chuck' match, trying word boundaries
2025-06-06 21:13:09,186 - __main__ - INFO - Found 0 records with word boundary matching
2025-06-06 21:13:09,186 - __main__ - WARNING - Still no records found for Beef Chuck
2025-06-06 21:13:09,186 - __main__ - INFO - Sample categories:
['Non Product', 'Non Product', 'Non Product', 'Pork Hams', 'Pork Hams', 'Pork Hams', 'Sausage', 'Poultry Ground', 'Poultry Ground', 'Poultry Ground']
2025-06-06 21:13:09,186 - __main__ - ERROR - No results to process. Exiting.
2025-06-06 21:14:06,203 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 21:14:06,203 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 21:14:06,203 - __main__ - INFO - 📥 Stage 1: Data Ingestion - Product Query Processing
2025-06-06 21:14:06,207 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 21:14:06,213 - __main__ - INFO - Read 1000 records from Product_Query_2025_06_06.csv with columns: ['ProductSK', 'SourceProductKey', 'ProductCode', 'ProductWarehouseCode', 'ProductDescription', 'ProductDescription2', 'ProductCategoryCode', 'ProductCategory', 'ProductMainCategoryCode', 'ProductMainCategory', 'WarehouseCode', 'Warehouse', 'WarehouseShort', 'ProcessCode', 'ProcessCodeDescription', 'AlphaName', 'BrandCode', 'BrandDescription', 'BrandRate', 'UnitOfMeasure_Stk', 'UnitOfMeasure_Alt', 'WeightConversion', 'UnitOfMeasure_Case', 'SourceSystems', 'LatestProductKeyVersion', 'IsCurrentRecordFlag']
2025-06-06 21:14:06,213 - __main__ - INFO - Test run: Processing only 10 products
2025-06-06 21:14:06,213 - data_ingestion.core.product_transformer - INFO - Processing product data: 10 records with columns ['ProductSK', 'SourceProductKey', 'ProductCode', 'ProductWarehouseCode', 'ProductDescription', 'ProductDescription2', 'ProductCategoryCode', 'ProductCategory', 'ProductMainCategoryCode', 'ProductMainCategory', 'WarehouseCode', 'Warehouse', 'WarehouseShort', 'ProcessCode', 'ProcessCodeDescription', 'AlphaName', 'BrandCode', 'BrandDescription', 'BrandRate', 'UnitOfMeasure_Stk', 'UnitOfMeasure_Alt', 'WeightConversion', 'UnitOfMeasure_Case', 'SourceSystems', 'LatestProductKeyVersion', 'IsCurrentRecordFlag']
2025-06-06 21:14:06,214 - data_ingestion.core.product_transformer - INFO - Primary description column 'ProductDescription' stats: 10 total rows, 0 null values, 0 empty strings
2025-06-06 21:14:06,214 - data_ingestion.core.product_transformer - INFO - Secondary description column 'ProductDescription2' stats: 10 total rows, 7 null values, 0 empty strings
2025-06-06 21:14:06,215 - data_ingestion.core.product_transformer - INFO - Merged description column 'product_description' stats: 10 total rows, 0 null values, 0 empty strings
2025-06-06 21:14:06,215 - data_ingestion.core.product_transformer - INFO - Mapped ProductCategory to category_description with 4 unique categories
2025-06-06 21:14:06,215 - data_ingestion.core.product_transformer - INFO - Mapped BrandName to brand_name
2025-06-06 21:14:06,216 - data_ingestion.core.product_transformer - INFO - Mapped ProductCode to product_code
2025-06-06 21:14:06,216 - data_ingestion.core.product_transformer - INFO - Mapped ProductDescription to product_description
2025-06-06 21:14:06,216 - data_ingestion.core.product_transformer - INFO - Final validation successful. Processed 10 records with required columns present.
2025-06-06 21:14:06,217 - data_ingestion.core.product_transformer - INFO - Product description column stats: count                         10
unique                         4
top       MATRIX PRICING PRODUCT
freq                           3
Name: product_description, dtype: object
2025-06-06 21:14:06,217 - data_ingestion.core.product_transformer - INFO - Processed 10 product records with transformations
2025-06-06 21:14:06,237 - __main__ - INFO - Saved processed product data with 10 records to data/processed/product_query_processed.parquet
2025-06-06 21:14:06,238 - __main__ - INFO - Also saved as CSV to data/processed/product_query_processed.csv
2025-06-06 21:14:06,238 - __main__ - INFO - ✅ Successfully processed product query data
2025-06-06 21:14:06,238 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 21:14:06,499 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:14:06,499 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:14:06,499 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 21:14:06,499 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 21:14:06,529 - __main__ - INFO - Loaded 10 records from processed product query data
2025-06-06 21:14:06,530 - __main__ - INFO - Available categories in data: ['Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground']
2025-06-06 21:14:06,530 - __main__ - INFO - Category counts: {'Non Product': 3, 'Pork Hams': 3, 'Poultry Ground': 3, 'Sausage': 1}
2025-06-06 21:14:06,530 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 21:14:06,531 - __main__ - INFO - Found 0 records for Beef Chuck
2025-06-06 21:14:06,531 - __main__ - WARNING - No records found for exact 'Beef Chuck' match, trying word boundaries
2025-06-06 21:14:06,532 - __main__ - INFO - Found 0 records with word boundary matching
2025-06-06 21:14:06,532 - __main__ - WARNING - Still no records found for Beef Chuck
2025-06-06 21:14:06,532 - __main__ - INFO - Sample categories:
['Non Product', 'Non Product', 'Non Product', 'Pork Hams', 'Pork Hams', 'Pork Hams', 'Sausage', 'Poultry Ground', 'Poultry Ground', 'Poultry Ground']
2025-06-06 21:14:06,532 - __main__ - ERROR - No results to process. Exiting.
2025-06-06 21:15:13,218 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 21:15:13,219 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 21:15:13,219 - __main__ - INFO - 📥 Stage 1: Data Ingestion - Product Query Processing
2025-06-06 21:15:13,221 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 21:15:13,226 - __main__ - INFO - Read 1000 records from Product_Query_2025_06_06.csv with columns: ['ProductSK', 'SourceProductKey', 'ProductCode', 'ProductWarehouseCode', 'ProductDescription', 'ProductDescription2', 'ProductCategoryCode', 'ProductCategory', 'ProductMainCategoryCode', 'ProductMainCategory', 'WarehouseCode', 'Warehouse', 'WarehouseShort', 'ProcessCode', 'ProcessCodeDescription', 'AlphaName', 'BrandCode', 'BrandDescription', 'BrandRate', 'UnitOfMeasure_Stk', 'UnitOfMeasure_Alt', 'WeightConversion', 'UnitOfMeasure_Case', 'SourceSystems', 'LatestProductKeyVersion', 'IsCurrentRecordFlag']
2025-06-06 21:15:13,227 - __main__ - INFO - Full dataset contains 60 unique categories: ['Non Product', 'Pork Hams', 'Sausage', 'Poultry Ground', 'Miscellaneous Beef', 'Pork Rib', 'Pork Other', 'Rib', 'Beef Flank', 'Pork Loin', 'Misc. Items', 'Beef Chuck', 'Chicken Misc.', 'Chicken Airline Breast', 'Ground Beef Anmar Production', 'Beef Variety & Misc', 'Beef Other', 'Delete Items', 'Beef Rib', 'Beef Ground', 'Lamb', 'Hot Dogs', 'Beef Round', 'Pork Sausage', 'Beef Loin', 'Goat', 'Wild Game', 'Veal', 'Halal', 'Supplies', 'Pot Sticker', 'Dim Sum', 'Beef,Pork-Sausage,Smok', 'Pork Ham/Leg', 'Rabbit', 'DISCONTINUED ITEMS', 'Pork Butt', 'Chicken Main', 'Pork Variety', 'Ground Beef', 'Poultry Leg', 'Pork Shoulder', 'Pork Belly', 'Veal Strauss', 'Brisket', 'Chicken Variety', 'Plate', 'Game Meat', 'Duck', 'Poultry Breast', 'Poultry Whole', 'Turkey', 'Poultry Drumstick', 'Poultry Thigh', 'Poultry Tender', 'Poultry Wing', 'Poultry Other', 'Misc', 'Chicken Wings', 'Chicken Leg Meat']
2025-06-06 21:15:13,227 - __main__ - INFO - Top 5 categories by count: {'Beef Rib': 87, 'Pork Loin': 85, 'Pork Other': 81, 'Beef Flank': 80, 'Beef Chuck': 68}
2025-06-06 21:15:13,227 - __main__ - INFO - Test run: Processing only 10 products
2025-06-06 21:15:13,227 - data_ingestion.core.product_transformer - INFO - Processing product data: 10 records with columns ['ProductSK', 'SourceProductKey', 'ProductCode', 'ProductWarehouseCode', 'ProductDescription', 'ProductDescription2', 'ProductCategoryCode', 'ProductCategory', 'ProductMainCategoryCode', 'ProductMainCategory', 'WarehouseCode', 'Warehouse', 'WarehouseShort', 'ProcessCode', 'ProcessCodeDescription', 'AlphaName', 'BrandCode', 'BrandDescription', 'BrandRate', 'UnitOfMeasure_Stk', 'UnitOfMeasure_Alt', 'WeightConversion', 'UnitOfMeasure_Case', 'SourceSystems', 'LatestProductKeyVersion', 'IsCurrentRecordFlag']
2025-06-06 21:15:13,228 - data_ingestion.core.product_transformer - INFO - Primary description column 'ProductDescription' stats: 10 total rows, 0 null values, 0 empty strings
2025-06-06 21:15:13,228 - data_ingestion.core.product_transformer - INFO - Secondary description column 'ProductDescription2' stats: 10 total rows, 7 null values, 0 empty strings
2025-06-06 21:15:13,229 - data_ingestion.core.product_transformer - INFO - Merged description column 'product_description' stats: 10 total rows, 0 null values, 0 empty strings
2025-06-06 21:15:13,229 - data_ingestion.core.product_transformer - INFO - Mapped ProductCategory to category_description with 4 unique categories
2025-06-06 21:15:13,230 - data_ingestion.core.product_transformer - INFO - Mapped BrandName to brand_name
2025-06-06 21:15:13,230 - data_ingestion.core.product_transformer - INFO - Mapped ProductCode to product_code
2025-06-06 21:15:13,230 - data_ingestion.core.product_transformer - INFO - Mapped ProductDescription to product_description
2025-06-06 21:15:13,230 - data_ingestion.core.product_transformer - INFO - Final validation successful. Processed 10 records with required columns present.
2025-06-06 21:15:13,231 - data_ingestion.core.product_transformer - INFO - Product description column stats: count                         10
unique                         4
top       MATRIX PRICING PRODUCT
freq                           3
Name: product_description, dtype: object
2025-06-06 21:15:13,231 - data_ingestion.core.product_transformer - INFO - Processed 10 product records with transformations
2025-06-06 21:15:13,251 - __main__ - INFO - Saved processed product data with 10 records to data/processed/product_query_processed.parquet
2025-06-06 21:15:13,252 - __main__ - INFO - Also saved as CSV to data/processed/product_query_processed.csv
2025-06-06 21:15:13,252 - __main__ - INFO - ✅ Successfully processed product query data
2025-06-06 21:15:13,252 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 21:15:13,503 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:15:13,503 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:15:13,503 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 21:15:13,503 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 21:15:13,531 - __main__ - INFO - Loaded 10 records from processed product query data
2025-06-06 21:15:13,531 - __main__ - INFO - Available categories in data: ['Non Product' 'Pork Hams' 'Sausage' 'Poultry Ground']
2025-06-06 21:15:13,532 - __main__ - INFO - Category counts: {'Non Product': 3, 'Pork Hams': 3, 'Poultry Ground': 3, 'Sausage': 1}
2025-06-06 21:15:13,532 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 21:15:13,532 - __main__ - INFO - Found 0 records for Beef Chuck
2025-06-06 21:15:13,532 - __main__ - WARNING - No records found for exact 'Beef Chuck' match, trying word boundaries
2025-06-06 21:15:13,532 - __main__ - INFO - Found 0 records with word boundary matching
2025-06-06 21:15:13,532 - __main__ - WARNING - Still no records found for Beef Chuck
2025-06-06 21:15:13,533 - __main__ - INFO - Sample categories:
['Non Product', 'Non Product', 'Non Product', 'Pork Hams', 'Pork Hams', 'Pork Hams', 'Sausage', 'Poultry Ground', 'Poultry Ground', 'Poultry Ground']
2025-06-06 21:15:13,533 - __main__ - ERROR - No results to process. Exiting.
2025-06-06 21:17:22,166 - __main__ - INFO - 🚀 Starting Meat Inventory Pipeline
2025-06-06 21:17:22,166 - __main__ - INFO - Categories to process: ['Beef Chuck']
2025-06-06 21:17:22,166 - __main__ - INFO - 📥 Stage 1: Data Ingestion - Product Query Processing
2025-06-06 21:17:22,168 - __main__ - INFO - Processing product query file: Product_Query_2025_06_06.csv
2025-06-06 21:17:22,174 - __main__ - INFO - Read 1000 records from Product_Query_2025_06_06.csv with columns: ['ProductSK', 'SourceProductKey', 'ProductCode', 'ProductWarehouseCode', 'ProductDescription', 'ProductDescription2', 'ProductCategoryCode', 'ProductCategory', 'ProductMainCategoryCode', 'ProductMainCategory', 'WarehouseCode', 'Warehouse', 'WarehouseShort', 'ProcessCode', 'ProcessCodeDescription', 'AlphaName', 'BrandCode', 'BrandDescription', 'BrandRate', 'UnitOfMeasure_Stk', 'UnitOfMeasure_Alt', 'WeightConversion', 'UnitOfMeasure_Case', 'SourceSystems', 'LatestProductKeyVersion', 'IsCurrentRecordFlag']
2025-06-06 21:17:22,175 - __main__ - INFO - Full dataset contains 60 unique categories: ['Non Product', 'Pork Hams', 'Sausage', 'Poultry Ground', 'Miscellaneous Beef', 'Pork Rib', 'Pork Other', 'Rib', 'Beef Flank', 'Pork Loin', 'Misc. Items', 'Beef Chuck', 'Chicken Misc.', 'Chicken Airline Breast', 'Ground Beef Anmar Production', 'Beef Variety & Misc', 'Beef Other', 'Delete Items', 'Beef Rib', 'Beef Ground', 'Lamb', 'Hot Dogs', 'Beef Round', 'Pork Sausage', 'Beef Loin', 'Goat', 'Wild Game', 'Veal', 'Halal', 'Supplies', 'Pot Sticker', 'Dim Sum', 'Beef,Pork-Sausage,Smok', 'Pork Ham/Leg', 'Rabbit', 'DISCONTINUED ITEMS', 'Pork Butt', 'Chicken Main', 'Pork Variety', 'Ground Beef', 'Poultry Leg', 'Pork Shoulder', 'Pork Belly', 'Veal Strauss', 'Brisket', 'Chicken Variety', 'Plate', 'Game Meat', 'Duck', 'Poultry Breast', 'Poultry Whole', 'Turkey', 'Poultry Drumstick', 'Poultry Thigh', 'Poultry Tender', 'Poultry Wing', 'Poultry Other', 'Misc', 'Chicken Wings', 'Chicken Leg Meat']
2025-06-06 21:17:22,175 - __main__ - INFO - Top 5 categories by count: {'Beef Rib': 87, 'Pork Loin': 85, 'Pork Other': 81, 'Beef Flank': 80, 'Beef Chuck': 68}
2025-06-06 21:17:22,176 - __main__ - INFO - Found 68 records matching requested categories: ['Beef Chuck']
2025-06-06 21:17:22,178 - __main__ - INFO - Test run: Processing 10 products with 5 from requested categories
2025-06-06 21:17:22,178 - data_ingestion.core.product_transformer - INFO - Processing product data: 10 records with columns ['ProductSK', 'SourceProductKey', 'ProductCode', 'ProductWarehouseCode', 'ProductDescription', 'ProductDescription2', 'ProductCategoryCode', 'ProductCategory', 'ProductMainCategoryCode', 'ProductMainCategory', 'WarehouseCode', 'Warehouse', 'WarehouseShort', 'ProcessCode', 'ProcessCodeDescription', 'AlphaName', 'BrandCode', 'BrandDescription', 'BrandRate', 'UnitOfMeasure_Stk', 'UnitOfMeasure_Alt', 'WeightConversion', 'UnitOfMeasure_Case', 'SourceSystems', 'LatestProductKeyVersion', 'IsCurrentRecordFlag']
2025-06-06 21:17:22,179 - data_ingestion.core.product_transformer - INFO - Primary description column 'ProductDescription' stats: 10 total rows, 0 null values, 0 empty strings
2025-06-06 21:17:22,179 - data_ingestion.core.product_transformer - INFO - Secondary description column 'ProductDescription2' stats: 10 total rows, 3 null values, 0 empty strings
2025-06-06 21:17:22,180 - data_ingestion.core.product_transformer - INFO - Merged description column 'product_description' stats: 10 total rows, 0 null values, 0 empty strings
2025-06-06 21:17:22,180 - data_ingestion.core.product_transformer - INFO - Mapped ProductCategory to category_description with 3 unique categories
2025-06-06 21:17:22,181 - data_ingestion.core.product_transformer - INFO - Mapped BrandName to brand_name
2025-06-06 21:17:22,181 - data_ingestion.core.product_transformer - INFO - Mapped ProductCode to product_code
2025-06-06 21:17:22,181 - data_ingestion.core.product_transformer - INFO - Mapped ProductDescription to product_description
2025-06-06 21:17:22,182 - data_ingestion.core.product_transformer - INFO - Final validation successful. Processed 10 records with required columns present.
2025-06-06 21:17:22,182 - data_ingestion.core.product_transformer - INFO - Product description column stats: count                                10
unique                                4
top       BF CHUCK SCOTCH TENDER NR AME
freq                                  4
Name: product_description, dtype: object
2025-06-06 21:17:22,182 - data_ingestion.core.product_transformer - INFO - Processed 10 product records with transformations
2025-06-06 21:17:22,203 - __main__ - INFO - Saved processed product data with 10 records to data/processed/product_query_processed.parquet
2025-06-06 21:17:22,204 - __main__ - INFO - Also saved as CSV to data/processed/product_query_processed.csv
2025-06-06 21:17:22,205 - __main__ - INFO - ✅ Successfully processed product query data
2025-06-06 21:17:22,205 - __main__ - INFO - 🤖 Stage 2: LLM Extraction
2025-06-06 21:17:22,456 - src.data_ingestion.utils.reference_data_loader - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:17:22,456 - src.extractors.beef_extractor - INFO - Loaded reference data for 11 primal cuts
2025-06-06 21:17:22,456 - __main__ - INFO - Loaded unified beef extractor with 11 supported primal cuts
2025-06-06 21:17:22,456 - __main__ - INFO - Using unified beef extractor for category: Beef Chuck (Primal: Chuck)
2025-06-06 21:17:22,484 - __main__ - INFO - Loaded 10 records from processed product query data
2025-06-06 21:17:22,484 - __main__ - INFO - Available categories in data: ['Non Product' 'Beef Chuck' 'Pork Hams']
2025-06-06 21:17:22,484 - __main__ - INFO - Category counts: {'Beef Chuck': 5, 'Non Product': 3, 'Pork Hams': 2}
2025-06-06 21:17:22,484 - __main__ - INFO - Processing category: Beef Chuck
2025-06-06 21:17:22,485 - __main__ - INFO - Found 5 records for Beef Chuck
2025-06-06 21:17:22,485 - __main__ - INFO - Test run: Processing only 5 records
2025-06-06 21:17:22,485 - llm_extraction.batch_processor - INFO - Processing 5 records for Beef Chuck
2025-06-06 21:17:22,628 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-9d4c763b-a47e-45c4-89b9-c5b92b6d33f7', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK BI ARM/SEC CH *__"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:22,651 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:23,090 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-b61d1d00-ae4f-4cef-a1e0-ae2767237faa', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK SCOTCH TENDER NR AME"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:23,092 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:23,092 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-3bfe3602-f101-4b41-8f1d-fcd6e309f3e5', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK SCOTCH TENDER NR AME"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:23,093 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-561d16f0-3d62-485a-8899-b53c75cac0d5', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK SCOTCH TENDER NR AME"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:23,094 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-31325dee-3db9-4bb5-9118-fb1d8dab41a6', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK SCOTCH TENDER NR AME"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:23,095 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:23,095 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:23,096 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:24,024 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:24,026 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 01:17:24 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1038'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1045'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999723'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_5d30a21505362383605725b443042c06'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=fJPvkyM60smVWfsF9dYRmMN3Cw6aQzXc1Z6KbCXSVGM-1749259044-1.0.1.1-LVj0l2creNsqs.ELqHcmMxd9KJ48nLMC.NsJOxMLSLAZvz1g46z50CRNsZRAvEL6g7V1CS.xD54cUyFDJVhx2ucEN_SUT4q2sDqNcBEbPLY; path=/; expires=Sat, 07-Jun-25 01:47:24 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=WSmg.NBx2_C0lrt0pvMeMveemA6LxN.2dEX3jC5VKXM-1749259044012-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc4f395da18fb8-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 21:17:24,026 - openai._base_client - DEBUG - request_id: req_5d30a21505362383605725b443042c06
2025-06-06 21:17:24,035 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 21:17:24,517 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:24,519 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 01:17:24 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1047'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1049'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999722'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_6f33e7b5ff6be79a52b63c27eb50bcfc'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=ZgpRr6ZIxv11goiLy6D0X0N0FSRcIEVvKlvEAKHvk9E-1749259044-1.0.1.1-1qSXcfEAtRLK2mOJwM7_5oRCQSwuBmFA6rE6H77rkooWi_v5pq6te3tEJP_li51IZl6EGTDjdgUawu0PzRsdjV4vLIGCwac9nM7sojykvVU; path=/; expires=Sat, 07-Jun-25 01:47:24 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=SCSY7_dOqLU9DRgL.TM7osq6qeOdbrd3SHrR9tYATWU-1749259044438-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc4f3befff4d1e-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 21:17:24,519 - openai._base_client - DEBUG - request_id: req_6f33e7b5ff6be79a52b63c27eb50bcfc
2025-06-06 21:17:24,520 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 21:17:24,539 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-572b8bd0-f49c-48b2-86d7-8efaf72dd06c', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK BI ARM/SEC CH *__"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:24,540 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:24,638 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:24,650 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 01:17:24 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1137'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1140'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999722'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_ec160b73310987ad55d738882b738542'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=BkPYMMEA_JR4ZBiPYAxWDOedoxMxO61kkyEsTxTq8IE-1749259044-1.0.1.1-XDrODEno2vsqR7DGysqIlSh5O9bAs6h1R5aFGLWZQVlQ6OqOa5Mo7trOQEnDVOHBgZb_ECgdSJDEcSQ5XcCFVb4EBw3AxpQ9S8Goas_dNA0; path=/; expires=Sat, 07-Jun-25 01:47:24 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=YkPhDRuc9tlLrBAY67z3Hfo2Gh6GQomtFDejh13Pwcw-1749259044634-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc4f3bea803035-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 21:17:24,650 - openai._base_client - DEBUG - request_id: req_ec160b73310987ad55d738882b738542
2025-06-06 21:17:24,650 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 21:17:24,708 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:24,708 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 01:17:24 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1081'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1085'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999722'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_9d677931b73ec34ae301a2b2370925c9'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=4QMLdgGyvexddNR4CYXsRsOlhtQJpRa38bgijkFmdDM-1749259044-1.0.1.1-9FRB0dQHf7CEX9hXEtwcofuN3KesrrNJ5sqSRvt6N3GSZn3t6eorWq6j30PoyHWxJZRgQ9ch8weTJ6W1hbqDLjL.QvZeUPX9V56mQ8QqHfU; path=/; expires=Sat, 07-Jun-25 01:47:24 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=3OfootBFcQ_6wXRrXu_nKVY8SkbBwiPpaGI8z5.gq0Y-1749259044704-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc4f3bfd198f79-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 21:17:24,708 - openai._base_client - DEBUG - request_id: req_9d677931b73ec34ae301a2b2370925c9
2025-06-06 21:17:24,709 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 21:17:24,737 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:24,739 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Sat, 07 Jun 2025 01:17:24 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-gblyqg98zxrogzddqhkvjahb'), ('openai-processing-ms', '1245'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '1250'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '4000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '3999722'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '4ms'), ('x-request-id', 'req_f83bdc67a161375effeabfeb44cfa4e5'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=v_5FP0JE13dfPTk7.tieHR4r0c1n3Tqrmf2nN6dpuLQ-1749259044-1.0.1.1-Aw4HTxq1e19xJqT1kpIrDxgarIebV0VbZYTxg6BYASPqQaZxT8SceH5t4CWLuGR3KJK25hJXOaN5nlg7UaOabWJZHIOUEiXnV7qE4S2EVKA; path=/; expires=Sat, 07-Jun-25 01:47:24 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=z_fppRw74F47fQAKAT1kQXLPcP4a8wLp2bopCqW1EqA-1749259044732-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '94bc4f3be92a3b7c-BOS'), ('content-encoding', 'br'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-06-06 21:17:24,739 - openai._base_client - DEBUG - request_id: req_f83bdc67a161375effeabfeb44cfa4e5
2025-06-06 21:17:24,739 - llm_extraction.batch_processor - WARNING - Attempt 1 failed, retrying in 0.5s: asdict() should be called on dataclass instances
2025-06-06 21:17:25,024 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-35986697-c85f-4886-87eb-be0f37780e9b', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK SCOTCH TENDER NR AME"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:25,025 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:25,151 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-374de220-5a8b-4722-8fea-8935b59d5009', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK SCOTCH TENDER NR AME"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:25,151 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:25,210 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-b9e10a12-e09d-42b7-8bc1-157de87fc492', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK SCOTCH TENDER NR AME"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:25,210 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:25,230 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:25,232 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 01:17:25 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '581', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '596', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999724', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_323b0f7ebe53d688c052b96b96c688f8', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc4f449daa8fb8-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 21:17:25,232 - openai._base_client - DEBUG - request_id: req_323b0f7ebe53d688c052b96b96c688f8
2025-06-06 21:17:25,233 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 21:17:25,243 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-b430b41b-7316-40f5-8ff8-5e90f5467655', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK SCOTCH TENDER NR AME"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:25,243 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:26,217 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:26,218 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 01:17:26 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '871', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '875', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999722', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_2c8ab4becd3d53704acf64dc428bdfa1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc4f48fee48fb8-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 21:17:26,218 - openai._base_client - DEBUG - request_id: req_2c8ab4becd3d53704acf64dc428bdfa1
2025-06-06 21:17:26,219 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 21:17:26,234 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-688b780d-a290-4888-b3c4-e8b2d9439188', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK BI ARM/SEC CH *__"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:26,235 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:26,255 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:26,255 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 01:17:26 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1146', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1149', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999722', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_9eda24d1173f8c27e9a69214c4c40429', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc4f4788383035-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 21:17:26,256 - openai._base_client - DEBUG - request_id: req_9eda24d1173f8c27e9a69214c4c40429
2025-06-06 21:17:26,256 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 21:17:26,846 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:26,766 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:26,883 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 01:17:26 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1373', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1378', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999722', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_27c07014fc230e7e01dfe30ef3868e1a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc4f485cae8f79-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 21:17:26,894 - openai._base_client - DEBUG - request_id: req_27c07014fc230e7e01dfe30ef3868e1a
2025-06-06 21:17:26,895 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 21:17:26,904 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 01:17:26 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1339', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1344', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999722', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_04b3527dc4994befc0af988a0ec82cec', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc4f48a83b3b7c-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 21:17:26,905 - openai._base_client - DEBUG - request_id: req_04b3527dc4994befc0af988a0ec82cec
2025-06-06 21:17:26,908 - llm_extraction.batch_processor - WARNING - Attempt 2 failed, retrying in 1.0s: asdict() should be called on dataclass instances
2025-06-06 21:17:27,225 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-ae8f96d3-e26a-4e0a-b421-d721bd44d5ec', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK SCOTCH TENDER NR AME"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:27,225 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:27,261 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-126e5a1c-1ee1-49ac-aa94-be61042f368b', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK SCOTCH TENDER NR AME"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:27,262 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:27,476 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:27,483 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 01:17:27 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1132', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1140', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999724', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_da4e29db867570011fdcc150b89652d3', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc4f4f2d118fb8-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 21:17:27,485 - openai._base_client - DEBUG - request_id: req_da4e29db867570011fdcc150b89652d3
2025-06-06 21:17:27,489 - llm_extraction.batch_processor - ERROR - All attempts failed for BF CHUCK BI ARM/SEC CH *__...: asdict() should be called on dataclass instances
2025-06-06 21:17:27,896 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-146f1ccb-4bc5-4ee5-abf8-54653a54abb6', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK SCOTCH TENDER NR AME"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:27,898 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:27,909 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-18f5ea22-35c4-4116-be90-f311143cab79', 'json_data': {'messages': [{'role': 'user', 'content': 'Extract beef attributes from this product description: "BF CHUCK SCOTCH TENDER NR AME"\n        \n        Product is from the Beef Chuck primal cut.\n        \n        Known subprimal cuts for Chuck include: Chuck Flap, Chuck Roll, Clod, Clod Shoulder, Clod Hearts, Flat Iron, Teres Major, Chuck Short Rib, Bone-In Chuck, Bone-In Arm, Top Blade, Blade Meat, ScottyTender, Mock Tender\n        \n        Extract these attributes:\n        1. Subprimal cut (from the list above or similar)\n        2. Grade (e.g., Prime, Choice, Select, No Grade)\n        3. Weight/Size (with unit, e.g., 10 lb)\n        4. Bone-in status (Yes/No)\n        5. Brand (if mentioned)\n        \n        Format response as JSON with fields: {\n            "subprimal": string or null,\n            "grade": string or null,\n            "weight": number or null,\n            "unit": string or null,\n            "bone_in": boolean,\n            "brand": string or null,\n            "confidence": number (0-1),\n            "needs_review": boolean\n        }\n        \n        Set needs_review to true if you\'re unsure about any attribution.'}], 'model': 'gpt-4o-mini', 'response_format': {'type': 'json_object'}}}
2025-06-06 21:17:27,910 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-06-06 21:17:28,414 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:28,415 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 01:17:28 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1109', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1113', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999722', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_db65b3044eb19cd00c290d8c383184d0', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc4f5538023035-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 21:17:28,415 - openai._base_client - DEBUG - request_id: req_db65b3044eb19cd00c290d8c383184d0
2025-06-06 21:17:28,415 - llm_extraction.batch_processor - ERROR - All attempts failed for BF CHUCK SCOTCH TENDER NR AME...: asdict() should be called on dataclass instances
2025-06-06 21:17:28,445 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:28,446 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 01:17:28 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1114', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1117', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999722', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_173f4c602fd35b3737567f4750100f34', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc4f557cae8f79-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 21:17:28,446 - openai._base_client - DEBUG - request_id: req_173f4c602fd35b3737567f4750100f34
2025-06-06 21:17:28,447 - llm_extraction.batch_processor - ERROR - All attempts failed for BF CHUCK SCOTCH TENDER NR AME...: asdict() should be called on dataclass instances
2025-06-06 21:17:29,266 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:29,272 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 01:17:29 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1269', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1279', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999722', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_e06206a1cf0898df01842f42bcbed233', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc4f597bd98fb8-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 21:17:29,273 - openai._base_client - DEBUG - request_id: req_e06206a1cf0898df01842f42bcbed233
2025-06-06 21:17:29,273 - llm_extraction.batch_processor - ERROR - All attempts failed for BF CHUCK SCOTCH TENDER NR AME...: asdict() should be called on dataclass instances
2025-06-06 21:17:29,556 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-06 21:17:29,596 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Sat, 07 Jun 2025 01:17:29 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-gblyqg98zxrogzddqhkvjahb', 'openai-processing-ms': '1016', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '1019', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '4000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '3999722', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '4ms', 'x-request-id': 'req_1c4567a93c5822eb578d3cb352d31e9b', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '94bc4f598f3a3b7c-BOS', 'content-encoding': 'br', 'alt-svc': 'h3=":443"; ma=86400'})
2025-06-06 21:17:29,604 - openai._base_client - DEBUG - request_id: req_1c4567a93c5822eb578d3cb352d31e9b
2025-06-06 21:17:29,614 - llm_extraction.batch_processor - ERROR - All attempts failed for BF CHUCK SCOTCH TENDER NR AME...: asdict() should be called on dataclass instances
2025-06-06 21:17:29,666 - llm_extraction.batch_processor - INFO - Batch processing complete. 5 records processed.
2025-06-06 21:17:29,666 - __main__ - INFO - Successfully processed 5 records for Beef Chuck
2025-06-06 21:17:29,666 - __main__ - INFO - 📤 Stage 3: Output Generation
2025-06-06 21:17:29,672 - output_generation.file_writer - INFO - Separated data: 0 clean records, 5 flagged records
2025-06-06 21:17:29,674 - output_generation.file_writer - INFO - Written 5 flagged records to outputs/beef_chuck_extracted_flagged.csv
2025-06-06 21:17:29,674 - __main__ - INFO - Output files created: ['Beef Chuck']
2025-06-06 21:17:29,674 - __main__ - INFO - ⏭️ Stage 4: Database Upload (Skipped - use --upload-to-firebase to enable)
2025-06-06 21:17:29,675 - __main__ - INFO - ✅ Pipeline Complete!
2025-06-06 21:17:29,675 - __main__ - INFO - 📊 Summary:
2025-06-06 21:17:29,675 - __main__ - INFO -    Total records processed: 5
2025-06-06 21:17:29,675 - __main__ - INFO -    Records needing review: 5 (100.0%)
2025-06-06 21:17:29,675 - __main__ - INFO -    Average confidence: 0.00
2025-06-06 21:17:29,675 - __main__ - WARNING - Some records need review - check flagged output files
